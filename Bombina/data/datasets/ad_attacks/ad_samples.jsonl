{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering Kerberoasting (Request TGS for SPNs, crack offline). Constraints: Requires domain authentication, targets service accounts. Analyze this attack path.", "output": "Kerberoasting targets service accounts with SPNs (Service Principal Names). Any authenticated domain user can request a TGS ticket for any SPN. The ticket is encrypted with the service account's password hash - extract and crack offline. Detection: Large numbers of TGS requests for SPNs is anomalous. Stealth approach: Request tickets slowly over time, target specific high-value SPNs rather than all SPNs. Tool selection: Rubeus kerberoast is common but has signatures - consider impacket GetUserSPNs.py or manual PowerShell. Focus on service accounts with weak passwords and adminCount=1 (privileged accounts)."}
{"instruction": "Evaluate whether to use Kerberoasting in current engagement.", "input": "Category: credential_access. Technique: Request TGS for SPNs, crack offline. What factors determine if this is the right approach?", "output": "Decision factors for Kerberoasting: Kerberoasting targets service accounts with SPNs (Service Principal Names). Any authenticated domain user can request a TGS ticket for any SPN. The ticket is encrypted with the service account's password hash - extract and crack offline. Detection: Large numbers of TGS requests for SPNs is anomalous. Stealth approach: Request tickets slowly over time, target specific high-value SPNs rather than al... Consider: 1) Do we meet the constraints (Requires domain authentication, targets service accounts)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (credential_access)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your Kerberoasting attack failed or was blocked.", "input": "The Request TGS for SPNs, crack offline technique didn't work as expected. What now?", "output": "When Kerberoasting fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires domain authentication, targets service accounts - are these actually met? 3) Alternative techniques in credential_access category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering AS-REP Roasting (Request AS-REP for accounts without pre-auth). Constraints: Requires accounts with Kerberos preauth disabled. Analyze this attack path.", "output": "Accounts with 'Do not require Kerberos preauthentication' enabled return AS-REP with data encrypted using the account's password hash. Can be requested without any authentication for known usernames. Detection: AS-REQ without preauthentication is logged (Event ID 4768). Stealth: This is quiet compared to Kerberoasting since you don't need to authenticate first. Enumerate DONT_REQ_PREAUTH accounts via LDAP. Common on legacy accounts or service accounts with compatibility requirements. Crack using hashcat mode 18200."}
{"instruction": "Evaluate whether to use AS-REP Roasting in current engagement.", "input": "Category: credential_access. Technique: Request AS-REP for accounts without pre-auth. What factors determine if this is the right approach?", "output": "Decision factors for AS-REP Roasting: Accounts with 'Do not require Kerberos preauthentication' enabled return AS-REP with data encrypted using the account's password hash. Can be requested without any authentication for known usernames. Detection: AS-REQ without preauthentication is logged (Event ID 4768). Stealth: This is quiet compared to Kerberoasting since you don't need to authenticate first. Enumerate DONT_REQ_PREAUTH accounts ... Consider: 1) Do we meet the constraints (Requires accounts with Kerberos preauth disabled)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (credential_access)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your AS-REP Roasting attack failed or was blocked.", "input": "The Request AS-REP for accounts without pre-auth technique didn't work as expected. What now?", "output": "When AS-REP Roasting fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires accounts with Kerberos preauth disabled - are these actually met? 3) Alternative techniques in credential_access category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering Golden Ticket (Forge TGT using KRBTGT hash). Constraints: Requires KRBTGT hash (domain compromise prerequisite). Analyze this attack path.", "output": "With the KRBTGT account hash, forge TGTs for any user including non-existent users. Provides complete domain control and persistence surviving password changes (until KRBTGT is rotated twice). Detection: Anomalous TGT lifetimes, forged PAC data, authentication from unusual sources. Requires initial domain compromise to obtain KRBTGT hash via DCSync or DC memory access. Stealth: Use legitimate user accounts rather than built-in admin. Match normal TGT lifetime (10 hours default). Detection risk is high if security monitoring is mature - behavioral analytics can detect Golden Ticket use."}
{"instruction": "Evaluate whether to use Golden Ticket in current engagement.", "input": "Category: persistence. Technique: Forge TGT using KRBTGT hash. What factors determine if this is the right approach?", "output": "Decision factors for Golden Ticket: With the KRBTGT account hash, forge TGTs for any user including non-existent users. Provides complete domain control and persistence surviving password changes (until KRBTGT is rotated twice). Detection: Anomalous TGT lifetimes, forged PAC data, authentication from unusual sources. Requires initial domain compromise to obtain KRBTGT hash via DCSync or DC memory access. Stealth: Use legitimate user... Consider: 1) Do we meet the constraints (Requires KRBTGT hash (domain compromise prerequisite))? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (persistence)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your Golden Ticket attack failed or was blocked.", "input": "The Forge TGT using KRBTGT hash technique didn't work as expected. What now?", "output": "When Golden Ticket fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires KRBTGT hash (domain compromise prerequisite) - are these actually met? 3) Alternative techniques in persistence category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering Silver Ticket (Forge TGS using service account hash). Constraints: Requires service account hash, limited to specific service. Analyze this attack path.", "output": "Forge service tickets using the service account's password hash. More targeted than Golden Ticket - grants access only to specific service. Does not touch DC during authentication - harder to detect. Detection: Tickets without corresponding TGT, anomalous service access patterns. Common targets: CIFS for file share access, LDAP for directory queries, HTTP for web services. Stealth: Silver Tickets never contact the DC, making detection harder. But service logs show the access. Best used for targeted data access rather than broad lateral movement."}
{"instruction": "Evaluate whether to use Silver Ticket in current engagement.", "input": "Category: persistence. Technique: Forge TGS using service account hash. What factors determine if this is the right approach?", "output": "Decision factors for Silver Ticket: Forge service tickets using the service account's password hash. More targeted than Golden Ticket - grants access only to specific service. Does not touch DC during authentication - harder to detect. Detection: Tickets without corresponding TGT, anomalous service access patterns. Common targets: CIFS for file share access, LDAP for directory queries, HTTP for web services. Stealth: Silver Tickets ... Consider: 1) Do we meet the constraints (Requires service account hash, limited to specific service)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (persistence)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your Silver Ticket attack failed or was blocked.", "input": "The Forge TGS using service account hash technique didn't work as expected. What now?", "output": "When Silver Ticket fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires service account hash, limited to specific service - are these actually met? 3) Alternative techniques in persistence category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering DCSync (Replicate AD credentials via DRSUAPI). Constraints: Requires replication privileges (high privilege prerequisite). Analyze this attack path.", "output": "Abuse replication privileges to request password hashes directly from DC without touching LSASS. Requires: Replicating Directory Changes + Replicating Directory Changes All (typically Domain Admin or specific delegation). Detection: Event ID 4662 with specific GUIDs for replication. Very noisy in monitored environments. Stealth: Target specific accounts rather than full domain dump. Timing during backup windows may blend with legitimate replication. If DCSync is detected, consider alternative credential access via LSASS on endpoints instead."}
{"instruction": "Evaluate whether to use DCSync in current engagement.", "input": "Category: credential_access. Technique: Replicate AD credentials via DRSUAPI. What factors determine if this is the right approach?", "output": "Decision factors for DCSync: Abuse replication privileges to request password hashes directly from DC without touching LSASS. Requires: Replicating Directory Changes + Replicating Directory Changes All (typically Domain Admin or specific delegation). Detection: Event ID 4662 with specific GUIDs for replication. Very noisy in monitored environments. Stealth: Target specific accounts rather than full domain dump. Timing during ... Consider: 1) Do we meet the constraints (Requires replication privileges (high privilege prerequisite))? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (credential_access)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your DCSync attack failed or was blocked.", "input": "The Replicate AD credentials via DRSUAPI technique didn't work as expected. What now?", "output": "When DCSync fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires replication privileges (high privilege prerequisite) - are these actually met? 3) Alternative techniques in credential_access category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering Unconstrained Delegation Abuse (Capture TGTs from connecting users). Constraints: Requires compromised server with unconstrained delegation. Analyze this attack path.", "output": "Servers with unconstrained delegation cache TGTs of connecting users. Compromise the server \u2192 extract TGTs from memory \u2192 impersonate users including admins. Coercion techniques: Force high-privilege accounts to authenticate (PrinterBug, PetitPotam). Detection: Unusual authentication patterns, TGT use from unexpected sources. Stealth: Printer Bug coercion is common and may be overlooked. PetitPotam is newer and more likely monitored. Focus on servers where admin authentication is expected (file servers, management servers). LAPS deployment complicates but doesn't prevent."}
{"instruction": "Evaluate whether to use Unconstrained Delegation Abuse in current engagement.", "input": "Category: lateral_movement. Technique: Capture TGTs from connecting users. What factors determine if this is the right approach?", "output": "Decision factors for Unconstrained Delegation Abuse: Servers with unconstrained delegation cache TGTs of connecting users. Compromise the server \u2192 extract TGTs from memory \u2192 impersonate users including admins. Coercion techniques: Force high-privilege accounts to authenticate (PrinterBug, PetitPotam). Detection: Unusual authentication patterns, TGT use from unexpected sources. Stealth: Printer Bug coercion is common and may be overlooked. PetitPotam... Consider: 1) Do we meet the constraints (Requires compromised server with unconstrained delegation)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (lateral_movement)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your Unconstrained Delegation Abuse attack failed or was blocked.", "input": "The Capture TGTs from connecting users technique didn't work as expected. What now?", "output": "When Unconstrained Delegation Abuse fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires compromised server with unconstrained delegation - are these actually met? 3) Alternative techniques in lateral_movement category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering Constrained Delegation Abuse (S4U2Self + S4U2Proxy). Constraints: Requires account with constrained delegation configured. Analyze this attack path.", "output": "Accounts with constrained delegation can impersonate users to specific services. S4U2Self obtains ticket as any user to self. S4U2Proxy forwards to allowed service. If TRUSTED_TO_AUTH_FOR_DELEGATION set, can impersonate protected users. Detection: Service-for-User extensions in Kerberos logs. Tool: Rubeus s4u. Enumeration: Find accounts with msDS-AllowedToDelegateTo attribute populated. The attack is service-specific but can be powerful if delegation targets CIFS, LDAP, or HTTP on sensitive servers."}
{"instruction": "Evaluate whether to use Constrained Delegation Abuse in current engagement.", "input": "Category: lateral_movement. Technique: S4U2Self + S4U2Proxy. What factors determine if this is the right approach?", "output": "Decision factors for Constrained Delegation Abuse: Accounts with constrained delegation can impersonate users to specific services. S4U2Self obtains ticket as any user to self. S4U2Proxy forwards to allowed service. If TRUSTED_TO_AUTH_FOR_DELEGATION set, can impersonate protected users. Detection: Service-for-User extensions in Kerberos logs. Tool: Rubeus s4u. Enumeration: Find accounts with msDS-AllowedToDelegateTo attribute populated. The attack... Consider: 1) Do we meet the constraints (Requires account with constrained delegation configured)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (lateral_movement)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your Constrained Delegation Abuse attack failed or was blocked.", "input": "The S4U2Self + S4U2Proxy technique didn't work as expected. What now?", "output": "When Constrained Delegation Abuse fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires account with constrained delegation configured - are these actually met? 3) Alternative techniques in lateral_movement category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering Resource-Based Constrained Delegation (RBCD) (Write msDS-AllowedToActOnBehalfOfOtherIdentity). Constraints: Requires write access to target computer's AD object. Analyze this attack path.", "output": "If you can write to msDS-AllowedToActOnBehalfOfOtherIdentity on a computer, configure RBCD to allow controlled computer to impersonate users to target. Common escalation path: compromise user \u2192 create machine account \u2192 configure RBCD \u2192 impersonate admin to target. Requires: Write access to target computer object, any computer account we control. Detection: Attribute modification logged. Stealth: RBCD is newer and less monitored than traditional delegation. Machine account creation has quota (default 10) but is not suspicious. Very powerful when combined with LAPS abuse or workstation compromise."}
{"instruction": "Evaluate whether to use Resource-Based Constrained Delegation (RBCD) in current engagement.", "input": "Category: lateral_movement. Technique: Write msDS-AllowedToActOnBehalfOfOtherIdentity. What factors determine if this is the right approach?", "output": "Decision factors for Resource-Based Constrained Delegation (RBCD): If you can write to msDS-AllowedToActOnBehalfOfOtherIdentity on a computer, configure RBCD to allow controlled computer to impersonate users to target. Common escalation path: compromise user \u2192 create machine account \u2192 configure RBCD \u2192 impersonate admin to target. Requires: Write access to target computer object, any computer account we control. Detection: Attribute modification logged. Stealth: R... Consider: 1) Do we meet the constraints (Requires write access to target computer's AD object)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (lateral_movement)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your Resource-Based Constrained Delegation (RBCD) attack failed or was blocked.", "input": "The Write msDS-AllowedToActOnBehalfOfOtherIdentity technique didn't work as expected. What now?", "output": "When Resource-Based Constrained Delegation (RBCD) fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires write access to target computer's AD object - are these actually met? 3) Alternative techniques in lateral_movement category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering ESC1 - Enrollee Supplies Subject (Request certificate with arbitrary SAN). Constraints: Requires vulnerable certificate template. Analyze this attack path.", "output": "If certificate template allows enrollee to specify Subject Alternative Name (SAN), request certificate for any user (e.g., Domain Admin). Template vulnerable if: CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT flag set, enrollment rights granted to attackable principal, client authentication EKU. Detection: Certificate requests with non-matching subject. Tool: Certify.exe find /vulnerable, then Certify.exe request. This is currently one of the most powerful AD escalation paths. Stealth: Certificate issuance is logged but often not monitored. Use certificate immediately and don't persist if stealth is priority."}
{"instruction": "Evaluate whether to use ESC1 - Enrollee Supplies Subject in current engagement.", "input": "Category: privilege_escalation. Technique: Request certificate with arbitrary SAN. What factors determine if this is the right approach?", "output": "Decision factors for ESC1 - Enrollee Supplies Subject: If certificate template allows enrollee to specify Subject Alternative Name (SAN), request certificate for any user (e.g., Domain Admin). Template vulnerable if: CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT flag set, enrollment rights granted to attackable principal, client authentication EKU. Detection: Certificate requests with non-matching subject. Tool: Certify.exe find /vulnerable, then Certify.exe requ... Consider: 1) Do we meet the constraints (Requires vulnerable certificate template)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (privilege_escalation)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your ESC1 - Enrollee Supplies Subject attack failed or was blocked.", "input": "The Request certificate with arbitrary SAN technique didn't work as expected. What now?", "output": "When ESC1 - Enrollee Supplies Subject fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires vulnerable certificate template - are these actually met? 3) Alternative techniques in privilege_escalation category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering ESC4 - Vulnerable Template ACL (Modify certificate template). Constraints: Requires write access to certificate template. Analyze this attack path.", "output": "If you have write access to a certificate template, modify it to enable ESC1 conditions (supply subject, client auth EKU). Requires: WriteProperty or WriteDacl on template object. Modify template \u2192 request cert as admin \u2192 revert template. Detection: Template modification is logged. Stealth: Rapid modification, request, and revert reduces detection window. ADCS misconfigurations are common because templates are complex and often misconfigured during setup."}
{"instruction": "Evaluate whether to use ESC4 - Vulnerable Template ACL in current engagement.", "input": "Category: privilege_escalation. Technique: Modify certificate template. What factors determine if this is the right approach?", "output": "Decision factors for ESC4 - Vulnerable Template ACL: If you have write access to a certificate template, modify it to enable ESC1 conditions (supply subject, client auth EKU). Requires: WriteProperty or WriteDacl on template object. Modify template \u2192 request cert as admin \u2192 revert template. Detection: Template modification is logged. Stealth: Rapid modification, request, and revert reduces detection window. ADCS misconfigurations are common because ... Consider: 1) Do we meet the constraints (Requires write access to certificate template)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (privilege_escalation)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your ESC4 - Vulnerable Template ACL attack failed or was blocked.", "input": "The Modify certificate template technique didn't work as expected. What now?", "output": "When ESC4 - Vulnerable Template ACL fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires write access to certificate template - are these actually met? 3) Alternative techniques in privilege_escalation category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering ESC8 - NTLM Relay to ADCS HTTP (Relay NTLM to Certificate Authority). Constraints: Requires ADCS web enrollment, coercion capability. Analyze this attack path.", "output": "Relay NTLM authentication to ADCS web enrollment endpoint to obtain certificate as relayed user. Coerce high-privilege account to authenticate to attacker \u2192 relay to http://ca/certsrv \u2192 obtain admin certificate. Detection: Web enrollment logs show request source. Requires: Web enrollment enabled on CA, ability to coerce authentication. Stealth: Coercion + relay is noisy. PetitPotam coercion is monitored in mature environments. Success depends on speed - authentication coercion to certificate issuance before detection."}
{"instruction": "Evaluate whether to use ESC8 - NTLM Relay to ADCS HTTP in current engagement.", "input": "Category: privilege_escalation. Technique: Relay NTLM to Certificate Authority. What factors determine if this is the right approach?", "output": "Decision factors for ESC8 - NTLM Relay to ADCS HTTP: Relay NTLM authentication to ADCS web enrollment endpoint to obtain certificate as relayed user. Coerce high-privilege account to authenticate to attacker \u2192 relay to http://ca/certsrv \u2192 obtain admin certificate. Detection: Web enrollment logs show request source. Requires: Web enrollment enabled on CA, ability to coerce authentication. Stealth: Coercion + relay is noisy. PetitPotam coercion is mon... Consider: 1) Do we meet the constraints (Requires ADCS web enrollment, coercion capability)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (privilege_escalation)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your ESC8 - NTLM Relay to ADCS HTTP attack failed or was blocked.", "input": "The Relay NTLM to Certificate Authority technique didn't work as expected. What now?", "output": "When ESC8 - NTLM Relay to ADCS HTTP fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires ADCS web enrollment, coercion capability - are these actually met? 3) Alternative techniques in privilege_escalation category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering LSASS Memory Extraction (Dump LSASS process memory). Constraints: Requires local admin, heavily monitored by EDR. Analyze this attack path.", "output": "LSASS process contains cached credentials, Kerberos tickets, and NTLM hashes. Classic target but heavily monitored. Detection: Process access to LSASS (Sysmon Event 10), suspicious minidump creation. EDR products specifically monitor LSASS. Stealth alternatives: 1) Nanodump - uses syscalls to avoid userland hooks. 2) HandleKatz - duplicates handles instead of direct access. 3) Credential Guard bypass if applicable. 4) Target endpoints rather than servers - less monitoring. 5) Use comsvcs.dll MiniDump via rundll32. Each method has tradeoffs between reliability and detection."}
{"instruction": "Evaluate whether to use LSASS Memory Extraction in current engagement.", "input": "Category: credential_access. Technique: Dump LSASS process memory. What factors determine if this is the right approach?", "output": "Decision factors for LSASS Memory Extraction: LSASS process contains cached credentials, Kerberos tickets, and NTLM hashes. Classic target but heavily monitored. Detection: Process access to LSASS (Sysmon Event 10), suspicious minidump creation. EDR products specifically monitor LSASS. Stealth alternatives: 1) Nanodump - uses syscalls to avoid userland hooks. 2) HandleKatz - duplicates handles instead of direct access. 3) Credential Guard byp... Consider: 1) Do we meet the constraints (Requires local admin, heavily monitored by EDR)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (credential_access)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your LSASS Memory Extraction attack failed or was blocked.", "input": "The Dump LSASS process memory technique didn't work as expected. What now?", "output": "When LSASS Memory Extraction fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires local admin, heavily monitored by EDR - are these actually met? 3) Alternative techniques in credential_access category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering DPAPI Abuse (Decrypt domain DPAPI secrets). Constraints: Requires domain backup key or user password. Analyze this attack path.", "output": "DPAPI protects credentials stored by Windows applications. Domain backup key on DC can decrypt any domain user's DPAPI blobs. Target: Chrome passwords, RDP credentials, scheduled task credentials. Requires: Domain backup key (lsadump::backupkeys) or user's password. Detection: Backup key extraction from DC is logged. Stealth: DPAPI abuse on endpoints is quieter - if you have user context, decrypt their blobs locally. Domain backup key extraction is high-value but high-risk. Consider targeting specific users' DPAPI after workstation compromise."}
{"instruction": "Evaluate whether to use DPAPI Abuse in current engagement.", "input": "Category: credential_access. Technique: Decrypt domain DPAPI secrets. What factors determine if this is the right approach?", "output": "Decision factors for DPAPI Abuse: DPAPI protects credentials stored by Windows applications. Domain backup key on DC can decrypt any domain user's DPAPI blobs. Target: Chrome passwords, RDP credentials, scheduled task credentials. Requires: Domain backup key (lsadump::backupkeys) or user's password. Detection: Backup key extraction from DC is logged. Stealth: DPAPI abuse on endpoints is quieter - if you have user context, decrypt ... Consider: 1) Do we meet the constraints (Requires domain backup key or user password)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (credential_access)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your DPAPI Abuse attack failed or was blocked.", "input": "The Decrypt domain DPAPI secrets technique didn't work as expected. What now?", "output": "When DPAPI Abuse fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires domain backup key or user password - are these actually met? 3) Alternative techniques in credential_access category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering AD Connect Password Extraction (Extract sync account credentials). Constraints: Requires local admin on AD Connect server. Analyze this attack path.", "output": "Azure AD Connect stores credentials for directory synchronization. AADInternals can extract: MSOL service account (has DCSync rights), Azure AD sync account. Requires: Local admin on AD Connect server. Detection: Registry and file access on AD Connect server. This is a critical target in hybrid environments - provides path from on-prem to cloud or enables DCSync without Domain Admin. Stealth: Low visibility once on the server. The initial access to AD Connect server is the monitored phase."}
{"instruction": "Evaluate whether to use AD Connect Password Extraction in current engagement.", "input": "Category: credential_access. Technique: Extract sync account credentials. What factors determine if this is the right approach?", "output": "Decision factors for AD Connect Password Extraction: Azure AD Connect stores credentials for directory synchronization. AADInternals can extract: MSOL service account (has DCSync rights), Azure AD sync account. Requires: Local admin on AD Connect server. Detection: Registry and file access on AD Connect server. This is a critical target in hybrid environments - provides path from on-prem to cloud or enables DCSync without Domain Admin. Stealth: Low ... Consider: 1) Do we meet the constraints (Requires local admin on AD Connect server)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (credential_access)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your AD Connect Password Extraction attack failed or was blocked.", "input": "The Extract sync account credentials technique didn't work as expected. What now?", "output": "When AD Connect Password Extraction fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires local admin on AD Connect server - are these actually met? 3) Alternative techniques in credential_access category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering GPO Abuse (Modify Group Policy Objects). Constraints: Requires write access to GPO. Analyze this attack path.", "output": "GPO modification provides persistence and lateral movement. If you have write access to GPO linked to target OUs: deploy scheduled tasks, startup scripts, or credential harvesting. Enumeration: BloodHound shows GPO attack paths. Detection: GPO modifications are logged (Event 5136, 5137). Stealth: Modify existing scheduled tasks rather than creating new. Use GPOs linked to specific OUs rather than Default Domain Policy. Immediate scripts are more detectable than scheduled tasks with delayed execution."}
{"instruction": "Evaluate whether to use GPO Abuse in current engagement.", "input": "Category: persistence. Technique: Modify Group Policy Objects. What factors determine if this is the right approach?", "output": "Decision factors for GPO Abuse: GPO modification provides persistence and lateral movement. If you have write access to GPO linked to target OUs: deploy scheduled tasks, startup scripts, or credential harvesting. Enumeration: BloodHound shows GPO attack paths. Detection: GPO modifications are logged (Event 5136, 5137). Stealth: Modify existing scheduled tasks rather than creating new. Use GPOs linked to specific OUs rather than ... Consider: 1) Do we meet the constraints (Requires write access to GPO)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (persistence)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your GPO Abuse attack failed or was blocked.", "input": "The Modify Group Policy Objects technique didn't work as expected. What now?", "output": "When GPO Abuse fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires write access to GPO - are these actually met? 3) Alternative techniques in persistence category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering GPP Credential Harvesting (Extract credentials from Group Policy Preferences). Constraints: Requires legacy GPP passwords to exist. Analyze this attack path.", "output": "Legacy GPP stored encrypted passwords in SYSVOL with published key (MS14-025). Any domain user can read SYSVOL. Modern environments shouldn't have these, but legacy policies persist. Detection: SYSVOL access is normal - extraction is not detectable. Search: Groups.xml, Services.xml, Scheduledtasks.xml, Datasources.xml. Tool: Get-GPPPassword. Low-risk, high-reward reconnaissance activity. Even patched environments may have old policies that were never removed."}
{"instruction": "Evaluate whether to use GPP Credential Harvesting in current engagement.", "input": "Category: credential_access. Technique: Extract credentials from Group Policy Preferences. What factors determine if this is the right approach?", "output": "Decision factors for GPP Credential Harvesting: Legacy GPP stored encrypted passwords in SYSVOL with published key (MS14-025). Any domain user can read SYSVOL. Modern environments shouldn't have these, but legacy policies persist. Detection: SYSVOL access is normal - extraction is not detectable. Search: Groups.xml, Services.xml, Scheduledtasks.xml, Datasources.xml. Tool: Get-GPPPassword. Low-risk, high-reward reconnaissance activity. Even patc... Consider: 1) Do we meet the constraints (Requires legacy GPP passwords to exist)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (credential_access)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your GPP Credential Harvesting attack failed or was blocked.", "input": "The Extract credentials from Group Policy Preferences technique didn't work as expected. What now?", "output": "When GPP Credential Harvesting fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires legacy GPP passwords to exist - are these actually met? 3) Alternative techniques in credential_access category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering Cross-Forest SID History Injection (Add SID to SIDHistory for cross-forest access). Constraints: Requires Domain Admin, trust without SID Filtering. Analyze this attack path.", "output": "With appropriate privileges in one forest, inject SIDs from trusted forest into SIDHistory. When authenticating across trust, SIDHistory SIDs are included in token. Requires: Domain Admin in source forest, trust without SID Filtering. Detection: SIDHistory modification is logged. SID Filtering should prevent this - check trust properties. If Quarantine is disabled (SID Filtering off), cross-forest escalation is possible. Valuable for attacking parent/child domain trusts and acquisitions with forest trusts."}
{"instruction": "Evaluate whether to use Cross-Forest SID History Injection in current engagement.", "input": "Category: lateral_movement. Technique: Add SID to SIDHistory for cross-forest access. What factors determine if this is the right approach?", "output": "Decision factors for Cross-Forest SID History Injection: With appropriate privileges in one forest, inject SIDs from trusted forest into SIDHistory. When authenticating across trust, SIDHistory SIDs are included in token. Requires: Domain Admin in source forest, trust without SID Filtering. Detection: SIDHistory modification is logged. SID Filtering should prevent this - check trust properties. If Quarantine is disabled (SID Filtering off), cross-forest... Consider: 1) Do we meet the constraints (Requires Domain Admin, trust without SID Filtering)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (lateral_movement)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your Cross-Forest SID History Injection attack failed or was blocked.", "input": "The Add SID to SIDHistory for cross-forest access technique didn't work as expected. What now?", "output": "When Cross-Forest SID History Injection fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires Domain Admin, trust without SID Filtering - are these actually met? 3) Alternative techniques in lateral_movement category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You are conducting an Active Directory penetration test.", "input": "Considering Trust Ticket Attack (Forge inter-realm TGT). Constraints: Requires trust key extraction. Analyze this attack path.", "output": "With trust key, forge inter-realm TGT to access trusted domain. Enumerate trust: nltest /domain_trusts. Extract trust key: lsadump::trust on DC. Forge ticket with appropriate SIDs for access to trusted domain. Detection: Anomalous inter-realm authentication. This provides access across trusts without compromising the target domain directly. Stealth: Inter-realm authentication is normal for users accessing cross-domain resources - blend with legitimate traffic patterns."}
{"instruction": "Evaluate whether to use Trust Ticket Attack in current engagement.", "input": "Category: lateral_movement. Technique: Forge inter-realm TGT. What factors determine if this is the right approach?", "output": "Decision factors for Trust Ticket Attack: With trust key, forge inter-realm TGT to access trusted domain. Enumerate trust: nltest /domain_trusts. Extract trust key: lsadump::trust on DC. Forge ticket with appropriate SIDs for access to trusted domain. Detection: Anomalous inter-realm authentication. This provides access across trusts without compromising the target domain directly. Stealth: Inter-realm authentication is normal for users a... Consider: 1) Do we meet the constraints (Requires trust key extraction)? 2) What's the detection risk vs. reward? 3) Are there quieter alternatives in the same category (lateral_movement)? 4) What access does success provide? Always enumerate current position thoroughly before committing to attack path."}
{"instruction": "Your Trust Ticket Attack attack failed or was blocked.", "input": "The Forge inter-realm TGT technique didn't work as expected. What now?", "output": "When Trust Ticket Attack fails: 1) Analyze why - missing permissions, detection/blocking, or misconfiguration? 2) Check constraints: Requires trust key extraction - are these actually met? 3) Alternative techniques in lateral_movement category should be considered. 4) Adjust detection tolerance - was it blocked by security controls or just incorrect execution? 5) Document the failure for reporting - blocked attacks inform defensive posture. Don't retry immediately if detected - reassess operational security."}
{"instruction": "You're conducting an internal AD pentest. EDR is deployed on all endpoints with LSASS protection.", "input": "Need credentials but traditional LSASS dump will be detected. What alternatives?", "output": "With EDR protecting LSASS, pivot to alternative credential sources: 1) Kerberoasting - no endpoint detection, attacks service accounts offline. 2) AS-REP Roasting - similar offline attack for accounts without preauth. 3) DPAPI extraction - less monitored than LSASS, can get Chrome passwords, RDP creds. 4) Cached credentials in registry (SECURITY hive) - requires offline extraction or local admin. 5) Targeted phishing for specific user credentials. 6) Check for credential files (unattend.xml, scripts with passwords). 7) Network credential capture (Responder if on same VLAN). The goal is finding credentials without touching LSASS. Prioritize Kerberoasting as it's quiet and effective against service accounts."}
{"instruction": "You've obtained Domain Admin through ADCS ESC1. How do you maintain persistence while avoiding detection?", "input": "Security team has SIEM with alerts on Domain Admin usage. Need stealth persistence.", "output": "Persistence after Domain Admin access with detection avoidance: 1) Create inconspicuous service account with DCSync rights rather than using Domain Admins - less monitored. 2) Certificate-based persistence - issue long-lived certificate for your service account. 3) Add controlled computer to Domain Controllers OU with constrained delegation - unusual but powerful. 4) RBCD configuration on sensitive servers - modify msDS-AllowedToActOnBehalfOfOtherIdentity. 5) Skeleton Key on DC - allows any password authentication, but requires service restart to remove. 6) Shadow Credentials - add Key Credential to admin account for certificate-based auth. Avoid: Adding users to Domain Admins (heavily monitored), Golden Ticket use (behavioral detection), obvious service accounts. Prioritize certificate and delegation-based persistence."}
{"instruction": "BloodHound shows path to Domain Admin via constrained delegation. Path is 4 hops. Analyze the attack chain.", "input": "Compromised user \u2192 Server A (unconstrained) \u2192 Service Account (constrained to DC) \u2192 Domain Admin via S4U \u2192 DCSync", "output": "Attack chain analysis: Hop 1 (User \u2192 Server A): Need to compromise Server A with unconstrained delegation. Check for local admin via group membership or vulnerability. If server has LAPS, need to extract LAPS password. Hop 2 (Server A \u2192 Service Account): Unconstrained delegation captures TGTs. Coerce authentication from service account using PrinterBug or access service that authenticates back. Hop 3 (S4U to DC): With service account hash and constrained delegation to DC, use Rubeus s4u to impersonate Domain Admin to LDAP service. Hop 4 (DCSync): With Domain Admin TGS to DC LDAP, perform DCSync. Detection points: Coercion is detectable, S4U extensions logged, DCSync very visible. Timing: Execute rapidly to minimize detection window. Alternative: If first hop is risky, look for shorter paths in BloodHound."}
{"instruction": "SMB Signing is enforced across the domain. How does this affect your attack approach?", "input": "Compromised workstation, need lateral movement. NTLM relay blocked by SMB signing.", "output": "SMB Signing mitigation adjustment: Relay attacks to SMB are blocked, but alternatives exist: 1) Relay to LDAP/LDAPS - often lacks signing requirement. Use for Shadow Credentials or RBCD attack. 2) Relay to HTTP services - ADCS web enrollment (ESC8), Exchange, SCCM. 3) Pass-the-Hash directly - signing doesn't prevent PTH, only relay. 4) Kerberos-based movement - overpass-the-hash, pass-the-ticket don't require SMB relay. 5) WMI/WinRM lateral movement - different protocol entirely. 6) Check for legacy systems without signing - older servers may not enforce. SMB signing blocks one technique but doesn't prevent lateral movement. Adjust tools: Use impacket ntlmrelayx with LDAP target, or switch to Kerberos-based authentication for lateral movement."}
{"instruction": "Target AD environment uses Credential Guard on all DCs and sensitive servers.", "input": "Standard LSASS dump returns empty results on Credential Guard systems. How to proceed?", "output": "Credential Guard isolates secrets in VSM - LSASS dump is ineffective. Approaches: 1) Target non-CG systems first - workstations often lack Credential Guard. 2) Kerberos attacks bypass CG entirely - Kerberoasting, AS-REP roasting, delegation abuse work regardless. 3) DPAPI extraction still works - Chrome passwords, RDP creds are not protected by CG. 4) DCSync works if you have replication rights - doesn't touch LSASS. 5) ADCS attacks - certificate-based authentication bypasses CG. 6) Shadow Credentials attack - Key Credential to msDS-KeyCredentialLink works against CG-protected accounts. 7) Network credential capture - Responder, relay attacks capture auth in transit. Key insight: Credential Guard protects LSASS memory but doesn't protect against Kerberos protocol abuse or authentication relay. Pivot strategy to these alternatives."}
