{"instruction": "Assess detection risk of proposed attack.", "input": "Plan to run Mimikatz for credential dumping on workstation with CrowdStrike Falcon deployed.", "output": "CRITICAL DETECTION RISK. CrowdStrike Falcon detection capabilities: 1) Mimikatz signature detection - all known variants blocked. 2) LSASS access monitoring - ANY process touching LSASS memory triggers alert. 3) Behavioral analysis - even custom dumpers detected by behavior. 4) Kernel-level hooks - cannot be bypassed from userland. Alternative approaches: 1) Kerberoasting - no LSASS touch required. 2) Internal Monologue - downgrade attack, lower risk. 3) Token manipulation - steal existing tokens without cred dump. 4) DPAPI secrets extraction - lower detection profile. 5) comsvcs.dll MiniDump - sometimes bypasses signature detection. Recommendation: Avoid direct credential dumping entirely. Use delegration attacks, Kerberos abuse, or harvest credentials from other sources (browsers, config files, cached creds)."}
{"instruction": "What will blue team see from this attack?", "input": "Running BloodHound collection with SharpHound across entire domain.", "output": "Blue team observables from SharpHound: 1) LDAP query volume spike - thousands of queries in short time from single source. 2) Query patterns - requests for all users, groups, computers, GPOs unusual from workstation. 3) SMB session enumeration - connections to many machines. 4) Windows Security events: 4624 (logons), 4662 (AD object access) from collection host. 5) Network traffic to many hosts on port 445. SOC alerts likely: 'Unusual LDAP activity', 'Potential reconnaissance', 'AD enumeration detected'. Mitigation for attacker: 1) Run collection over multiple days. 2) Target specific OUs, not entire domain. 3) Use stealth collection modes (--stealth in newer versions). 4) Run from server that normally queries AD (management host). Note: Even careful collection may trigger behavioral analytics in mature SOCs."}
{"instruction": "How to evade this specific detection.", "input": "Target uses Microsoft Defender for Endpoint. Need to run PowerShell payload.", "output": "MDE PowerShell evasion considerations: 1) AMSI (Antimalware Scan Interface) - scans PowerShell content in memory. 2) Script block logging - all PowerShell commands logged. 3) Constrained Language Mode may be enforced. 4) Behavioral detection on known attack patterns. Evasion techniques: 1) AMSI bypass - memory patching (detected quickly now) or find fresh bypass. 2) Use .NET directly instead of PowerShell - avoids AMSI in PS context. 3) Unmanaged code execution - AMSI doesn't hook native code. 4) Encode/obfuscate heavily BUT behavioral detection still applies. 5) Living-off-the-land - use legitimate signed binaries (LOLBAS). Recommended: Avoid PowerShell entirely for payload execution. Use C#, C++, or abuse legitimate admin tools. If PowerShell required, minimal staged approach with immediate cleanup."}
{"instruction": "Maintain persistence without detection.", "input": "Need persistence on Windows server. Defender and Sysmon logging deployed. EDR absent.", "output": "Sysmon + Defender environment - endpoint visibility but less behavioral analysis. Persistence options by detection risk: LOW RISK: 1) Scheduled task mimicking legitimate Windows tasks (check existing task names). 2) WMI event subscription - less commonly monitored than registry. 3) COM object hijacking - blends with normal COM usage. MEDIUM RISK: 1) Service creation - Sysmon Event ID 6 and 7. 2) Registry run keys - Sysmon Event ID 13. 3) Startup folder - obvious location. HIGH RISK: 1) DLL hijacking in protected paths. 2) Driver loading. 3) Boot record modification. Recommended: WMI subscription with legitimate-looking consumer name, or scheduled task copying existing Windows task naming conventions. Clean up failed attempts - Sysmon sees everything. Use legitimate directories (Windows, Program Files) not temp or user folders."}
{"instruction": "Evaluate OPSEC of planned exfiltration method.", "input": "Plan to exfil 500MB of data via HTTPS POST to external server.", "output": "HTTPS exfiltration OPSEC analysis: Positive: 1) Encrypted - content inspection difficult. 2) Port 443 typically allowed outbound. 3) Common traffic pattern. Risks: 1) 500MB is large - may trigger DLP volumetric alerts. 2) Single large transfer suspicious. 3) Unknown destination IP/domain flagged. 4) SSL inspection (MITM) at proxy reveals content. Improvements: 1) Chunk into smaller transfers over time (simulate normal browsing). 2) Use legitimate cloud service (OneDrive, Google Drive, Dropbox) - appears as normal sync. 3) Steganography in images if SSL inspection present. 4) DNS exfiltration for smaller datasets. 5) Use existing C2 channel with slow exfil. Recommended: Cloud storage with corporate account if available (blends perfectly), otherwise chunked HTTPS over multiple days. Avoid: Single large POST to unknown IP."}
