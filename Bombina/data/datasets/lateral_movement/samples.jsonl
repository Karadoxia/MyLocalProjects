{"instruction": "Plan lateral movement in an Active Directory environment.", "input": "You have local admin on one workstation. Target is file server with sensitive data. LAPS deployed, network segmented.", "output": "LAPS complicates credential reuse - each machine has unique local admin password. Strategy shift required: 1) Check if current user has RDP/admin rights on other machines via group membership. 2) Look for domain cached credentials that might work elsewhere. 3) Identify service accounts - these often have broader access than user accounts. 4) Check for over-permissioned shares accessible from current context. Avoid: Trying local admin creds on other machines (will fail with LAPS). Instead: Focus on domain-level access paths. Use BloodHound data to map shortest path to file server. Consider: Kerberos delegation abuse if service accounts are found."}
{"instruction": "You need to move laterally but PSRemoting is disabled.", "input": "Domain user credentials, target Windows server, WinRM blocked, SMB accessible, EDR present.", "output": "Without PSRemoting, lateral movement options: 1) SMB + scheduled task creation (schtasks) - creates task that runs as SYSTEM. 2) SMB + service creation (sc.exe) - more detectable but reliable. 3) WMI over DCOM - uses port 135 + dynamic ports. 4) PsExec-style named pipe execution. EDR considerations: Scheduled tasks and service creation are monitored but common. Use legitimate-looking task names. WMI is often less monitored than service creation. Recommended: WMI execution if DCOM is available, otherwise scheduled task with cleanup. Always delete artifacts after execution."}
{"instruction": "Move laterally in a Linux environment.", "input": "SSH access to web server, need to reach database server in internal network. No direct SSH access to DB.", "output": "Linux lateral movement typically via: 1) SSH key harvesting - check ~/.ssh/ for private keys, known_hosts for targets. 2) Credential reuse - check bash_history, config files, environment variables for passwords. 3) SSH agent hijacking - if agent forwarding enabled, abuse existing sessions. 4) Network pivoting - use compromised host as jump point. For reaching internal DB: Set up SSH tunnel (ssh -L) or SOCKS proxy (ssh -D). Check if web app has database credentials in config files (/var/www/, .env files). Recommended: Harvest credentials from web app config > attempt direct DB connection > pivot via SSH tunnel if needed."}
{"instruction": "Lateral movement in a cloud-hybrid environment.", "input": "Compromised on-prem workstation, Azure AD joined. Need to access Azure resources.", "output": "Azure AD join creates interesting pivot opportunities: 1) Check for Primary Refresh Token (PRT) - can be used to access Azure resources. 2) Look for Azure CLI/PowerShell cached credentials (~/.azure/, %USERPROFILE%\\.azure). 3) Managed Identity on the machine may have Azure permissions. 4) Check browser for cached Azure portal sessions. Tools: ROADtools for Azure AD enumeration, AADInternals for token manipulation. If PRT extraction successful, can access Azure as the user without password. Detection: Azure AD sign-in logs will show access - use existing session tokens to blend with normal activity."}
{"instruction": "Plan stealthy lateral movement with heavy monitoring.", "input": "SOC is active, SIEM collecting logs, need to move from DMZ to internal network.", "output": "Heavy monitoring requires living-off-the-land approach: 1) Use legitimate admin tools already present (RSAT, built-in Windows tools). 2) Move during business hours to blend with normal traffic. 3) Avoid mass scanning - single targeted connections only. 4) Use existing service accounts if compromised - their activity patterns are expected. For DMZ to internal: Identify legitimate data flows (backup, management traffic) and mimic them. Check for jump hosts or bastion servers that are expected to connect internally. Timing: Avoid moving immediately after initial access - let activity baseline normalize. Consider: DNS tunneling or HTTPS-based C2 that looks like normal web traffic."}
