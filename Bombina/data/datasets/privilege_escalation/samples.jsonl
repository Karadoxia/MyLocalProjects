{"instruction": "Escalate privileges on a Windows workstation.", "input": "Standard domain user on Windows 10 22H2. No local admin. UAC enabled. Need SYSTEM access.", "output": "Windows 10 22H2 privesc vectors: 1) Check for unquoted service paths with write access to path directories. 2) Look for misconfigured services with weak DACLs (accesschk.exe). 3) AlwaysInstallElevated registry check - allows MSI as SYSTEM. 4) Saved credentials in Credential Manager. 5) Scheduled tasks running as SYSTEM with writable scripts. 6) Print Spooler vulnerabilities if not patched. Enumeration first: Run winPEAS or manual checks before attempting exploits. UAC bypass may be needed first if targeting local admin - fodhelper, eventvwr methods. Recommended order: Service misconfigs > AlwaysInstallElevated > credential harvesting > kernel exploits as last resort."}
{"instruction": "Escalate privileges on a Linux server.", "input": "Low-privilege shell on Ubuntu 22.04 web server. Running as www-data. Need root.", "output": "Ubuntu 22.04 privesc checklist: 1) sudo -l - check for NOPASSWD entries or GTFOBins-exploitable binaries. 2) SUID/SGID binaries - find / -perm -4000 2>/dev/null. 3) Capabilities - getcap -r / 2>/dev/null. 4) Cron jobs running as root with writable scripts. 5) Writable /etc/passwd (unlikely but check). 6) Kernel version for known exploits (check with uname -a). 7) Docker group membership - instant root if present. 8) Check for password reuse in web app configs that might be root password. www-data context: Check web app for database creds, then look for password reuse. Automated: Run linPEAS for comprehensive enumeration. Focus on misconfigs over kernel exploits."}
{"instruction": "Privilege escalation in Active Directory.", "input": "Domain user with no special privileges. Need Domain Admin. Large enterprise environment.", "output": "AD privilege escalation paths: 1) Kerberoasting - request TGS for SPNs, crack offline. Low risk, high reward. 2) ASREPRoasting - find accounts without preauth. 3) ACL abuse - check for WriteDACL, GenericAll on sensitive objects. 4) Group membership exploitation - nested groups often grant unexpected access. 5) Constrained/Unconstrained delegation abuse. 6) ADCS exploitation - ESC1-ESC8 certificate template attacks. Recommended approach: Run BloodHound to map all paths to DA. Prioritize: Kerberoasting (silent) > ACL abuse > delegation > ADCS. Avoid: DCSync or direct DC attacks until you have path to high-privilege account. Detection: Kerberoasting generates 4769 events but is common in large environments."}
{"instruction": "Escalate privileges in a container environment.", "input": "Shell inside Docker container. Container is privileged. Need host access.", "output": "Privileged container = likely host compromise: 1) Check for mounted host filesystem - ls /host or mount output. 2) If privileged, can mount host disk: mount /dev/sda1 /mnt. 3) Access host /etc/shadow, add SSH key to root. 4) Abuse cgroups for container escape - notify_on_release technique. 5) Check for Docker socket mount (/var/run/docker.sock) - instant host access by spawning privileged container with host mount. Quick wins: Docker socket > direct mount > cgroup escape. If not privileged: Check for capabilities (cap_sys_admin), kernel exploits, or credential leakage in environment variables."}
{"instruction": "Privilege escalation after finding credentials.", "input": "Found cleartext password in configuration file. Password is 'Summer2024!'. Multiple users in domain.", "output": "Credential reuse attack strategy: 1) Do NOT spray against all accounts - triggers lockouts and detection. 2) Enumerate users with similar roles to where cred was found (same team/department). 3) Check for service accounts first - often share passwords and have higher privileges. 4) Test against non-production systems before production. 5) Use password with variations (Summer2024, Summer2024!!, Summer24) for password policy patterns. Target priority: Service accounts > IT admin accounts > same-department users. Timing: Test 1-2 accounts at a time with delays. If this is a service account password, check for SPNs and Kerberos delegation rights."}
