{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: User has permission to attach policies. The technique iam:AttachUserPolicy / iam:AttachRolePolicy appears possible. How do you approach this?", "output": "When a principal has iam:AttachUserPolicy or iam:AttachRolePolicy permissions, they can escalate privileges by attaching AdministratorAccess or custom high-privilege policies to themselves. Detection: CloudTrail logs show AttachUserPolicy/AttachRolePolicy events. The attack is noisy because policy changes are typically monitored. Alternative approach: If iam:PutUserPolicy is available, create inline policies which may evade some detection rules focused on managed policy attachment."}
{"instruction": "Evaluate the attack path: IAM Privilege Escalation via Policy Attachment in AWS.", "input": "Available technique: iam:AttachUserPolicy / iam:AttachRolePolicy. What are the tradeoffs?", "output": "Attack analysis for IAM Privilege Escalation via Policy Attachment: When a principal has iam:AttachUserPolicy or iam:AttachRolePolicy permissions, they can escalate privileges by attaching AdministratorAccess or custom high-privilege policies to themselves. Detection: CloudTrail logs show AttachUserPolicy/AttachRolePolicy events. The attack is noisy because policy changes are typically monitored. Alternative approach: If iam:PutUserPolicy is available, create inline policies which may evade some detection rules focused on managed policy attachment.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: User can create Lambda functions and pass roles. The technique lambda:CreateFunction + iam:PassRole appears possible. How do you approach this?", "output": "With lambda:CreateFunction and iam:PassRole, create a Lambda function that assumes a higher-privileged role. The function executes with the attached role's permissions. Detection risk: Medium - Lambda creation is logged but may not trigger alerts in dev environments. Key insight: Target roles with overly permissive trust policies that allow Lambda service principal. Check for roles with 'lambda.amazonaws.com' in trust policy."}
{"instruction": "Evaluate the attack path: Lambda Function Privilege Escalation in AWS.", "input": "Available technique: lambda:CreateFunction + iam:PassRole. What are the tradeoffs?", "output": "Attack analysis for Lambda Function Privilege Escalation: With lambda:CreateFunction and iam:PassRole, create a Lambda function that assumes a higher-privileged role. The function executes with the attached role's permissions. Detection risk: Medium - Lambda creation is logged but may not trigger alerts in dev environments. Key insight: Target roles with overly permissive trust policies that allow Lambda service principal. Check for roles with 'lambda.amazonaws.com' in trust policy.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: Can launch EC2 instances with IAM roles. The technique ec2:RunInstances + iam:PassRole appears possible. How do you approach this?", "output": "Launch an EC2 instance with a high-privilege instance profile attached. SSH into the instance and use the metadata service (169.254.169.254) to obtain temporary credentials. IMDSv2 enforcement adds complexity but can often be bypassed in misconfigured environments. Detection: ec2:RunInstances with iam:PassRole is logged. Stealth consideration: Use existing authorized AMIs to blend in."}
{"instruction": "Evaluate the attack path: EC2 Instance Profile Abuse in AWS.", "input": "Available technique: ec2:RunInstances + iam:PassRole. What are the tradeoffs?", "output": "Attack analysis for EC2 Instance Profile Abuse: Launch an EC2 instance with a high-privilege instance profile attached. SSH into the instance and use the metadata service (169.254.169.254) to obtain temporary credentials. IMDSv2 enforcement adds complexity but can often be bypassed in misconfigured environments. Detection: ec2:RunInstances with iam:PassRole is logged. Stealth consideration: Use existing authorized AMIs to blend in.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: Role trust policies allow assumption. The technique sts:AssumeRole across accounts/roles appears possible. How do you approach this?", "output": "Map out role trust relationships to find assumption chains leading to higher privileges. Cross-account roles often have overly permissive trust policies. Use enumerate-iam or pacu to discover assumable roles. The attack is relatively quiet - AssumeRole is normal behavior. Focus on roles trusting '*' or overly broad principals. Each hop in the chain provides new permissions to enumerate."}
{"instruction": "Evaluate the attack path: STS AssumeRole Chain in AWS.", "input": "Available technique: sts:AssumeRole across accounts/roles. What are the tradeoffs?", "output": "Attack analysis for STS AssumeRole Chain: Map out role trust relationships to find assumption chains leading to higher privileges. Cross-account roles often have overly permissive trust policies. Use enumerate-iam or pacu to discover assumable roles. The attack is relatively quiet - AssumeRole is normal behavior. Focus on roles trusting '*' or overly broad principals. Each hop in the chain provides new permissions to enumerate.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: User can modify S3 bucket policies. The technique s3:PutBucketPolicy appears possible. How do you approach this?", "output": "Modify bucket policy to grant yourself or an external account access to sensitive data. Can be used for data exfiltration or to establish persistence. Detection: S3 bucket policy changes are logged in CloudTrail and often monitored. Stealth approach: Add a condition that only allows access from specific IPs rather than granting broad public access. Consider time-limited policies that auto-expire."}
{"instruction": "Evaluate the attack path: S3 Bucket Policy Modification in AWS.", "input": "Available technique: s3:PutBucketPolicy. What are the tradeoffs?", "output": "Attack analysis for S3 Bucket Policy Modification: Modify bucket policy to grant yourself or an external account access to sensitive data. Can be used for data exfiltration or to establish persistence. Detection: S3 bucket policy changes are logged in CloudTrail and often monitored. Stealth approach: Add a condition that only allows access from specific IPs rather than granting broad public access. Consider time-limited policies that auto-expire.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: Can create CloudFormation stacks with IAM roles. The technique cloudformation:CreateStack + iam:PassRole appears possible. How do you approach this?", "output": "Create a CloudFormation stack that provisions resources with elevated IAM role. The stack executes with the passed role's permissions. Can create IAM users, roles, or EC2 instances with admin access. Detection: CloudFormation stack creation is logged. Stealth: Use legitimate-looking template names and descriptions. Consider deploying to less-monitored regions."}
{"instruction": "Evaluate the attack path: CloudFormation Stack Privilege Escalation in AWS.", "input": "Available technique: cloudformation:CreateStack + iam:PassRole. What are the tradeoffs?", "output": "Attack analysis for CloudFormation Stack Privilege Escalation: Create a CloudFormation stack that provisions resources with elevated IAM role. The stack executes with the passed role's permissions. Can create IAM users, roles, or EC2 instances with admin access. Detection: CloudFormation stack creation is logged. Stealth: Use legitimate-looking template names and descriptions. Consider deploying to less-monitored regions.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: Has SSM permissions, targets have SSM agent. The technique ssm:StartSession appears possible. How do you approach this?", "output": "Use SSM Session Manager to establish shell access to EC2 instances without SSH keys. Works even if security groups block SSH. Requires ssm:StartSession permission and target instance must have SSM agent running with appropriate IAM role. Detection: SSM sessions are logged in CloudTrail and Session Manager logs. Advantage: No need to modify security groups or have SSH keys."}
{"instruction": "Evaluate the attack path: SSM Session Manager Lateral Movement in AWS.", "input": "Available technique: ssm:StartSession. What are the tradeoffs?", "output": "Attack analysis for SSM Session Manager Lateral Movement: Use SSM Session Manager to establish shell access to EC2 instances without SSH keys. Works even if security groups block SSH. Requires ssm:StartSession permission and target instance must have SSM agent running with appropriate IAM role. Detection: SSM sessions are logged in CloudTrail and Session Manager logs. Advantage: No need to modify security groups or have SSH keys.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: Read access to secrets storage. The technique secretsmanager:GetSecretValue / ssm:GetParameter appears possible. How do you approach this?", "output": "Extract credentials, API keys, and sensitive configuration from Secrets Manager or SSM Parameter Store. Often contains database credentials, third-party API keys, or service account credentials. Detection: Get operations are logged but high volume makes monitoring difficult. Prioritize secrets with names suggesting database, admin, or production credentials. Check for rotation configuration - non-rotated secrets are higher value targets."}
{"instruction": "Evaluate the attack path: Secrets Manager / Parameter Store Extraction in AWS.", "input": "Available technique: secretsmanager:GetSecretValue / ssm:GetParameter. What are the tradeoffs?", "output": "Attack analysis for Secrets Manager / Parameter Store Extraction: Extract credentials, API keys, and sensitive configuration from Secrets Manager or SSM Parameter Store. Often contains database credentials, third-party API keys, or service account credentials. Detection: Get operations are logged but high volume makes monitoring difficult. Prioritize secrets with names suggesting database, admin, or production credentials. Check for rotation configuration - non-rotated secrets are higher value targets.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: GuardDuty is enabled in the account. The technique Behavioral evasion appears possible. How do you approach this?", "output": "GuardDuty detects anomalous API behavior, cryptocurrency mining, and known malicious IPs. Evasion strategies: 1) Use slow, low-volume reconnaissance to avoid behavioral anomalies. 2) Operate during business hours from geographic regions matching normal usage. 3) Avoid obvious indicators like scanning or brute force. 4) Use AWS-native tools (CLI, SDK) rather than third-party pentest tools with known signatures. 5) Disable GuardDuty if you have guardduty:DeleteDetector permission - but this is highly visible."}
{"instruction": "Evaluate the attack path: GuardDuty Evasion in AWS.", "input": "Available technique: Behavioral evasion. What are the tradeoffs?", "output": "Attack analysis for GuardDuty Evasion: GuardDuty detects anomalous API behavior, cryptocurrency mining, and known malicious IPs. Evasion strategies: 1) Use slow, low-volume reconnaissance to avoid behavioral anomalies. 2) Operate during business hours from geographic regions matching normal usage. 3) Avoid obvious indicators like scanning or brute force. 4) Use AWS-native tools (CLI, SDK) rather than third-party pentest tools with known signatures. 5) Disable GuardDuty if you have guardduty:DeleteDetector permission - but this is hig... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an AWS environment.", "input": "Scenario: Can modify resource policies on S3/KMS/SNS. The technique Resource-based policy abuse appears possible. How do you approach this?", "output": "Add cross-account access to resource policies allowing data exfiltration to attacker-controlled account. S3 bucket policies, KMS key policies, and SNS topic policies can grant cross-account access. Detection: Policy modifications are logged. Stealth: Use legitimate-looking account IDs (from same organization if compromised) rather than obviously external accounts. Consider using AWS Organizations to identify accounts that might have implicit trust."}
{"instruction": "Evaluate the attack path: Cross-Account Data Exfiltration in AWS.", "input": "Available technique: Resource-based policy abuse. What are the tradeoffs?", "output": "Attack analysis for Cross-Account Data Exfiltration: Add cross-account access to resource policies allowing data exfiltration to attacker-controlled account. S3 bucket policies, KMS key policies, and SNS topic policies can grant cross-account access. Detection: Policy modifications are logged. Stealth: Use legitimate-looking account IDs (from same organization if compromised) rather than obviously external accounts. Consider using AWS Organizations to identify accounts that might have implicit trust.... Key decision factors: detection likelihood, permission requirements, and persistence value. Always enumerate current permissions before attempting privilege escalation."}
{"instruction": "You are conducting a cloud penetration test against an Azure/Entra ID environment.", "input": "Scenario: User can create/modify app registrations. Considering Application.ReadWrite.All abuse. What's your approach?", "output": "With Application.ReadWrite.All permission, create an application with high-privilege API permissions and grant admin consent. Alternatively, add credentials to existing applications with elevated permissions. Detection: Application creation and modification is logged in Azure AD audit logs. Focus on applications with Directory.ReadWrite.All, RoleManagement.ReadWrite.Directory, or similar sensitive permissions. Check for applications without credential expiration or with multiple credentials (indicating potential abuse)."}
{"instruction": "Your attempt at Azure AD Privilege Escalation via App Registration in Azure failed due to insufficient permissions.", "input": "Need to find alternative escalation path. What do you check next?", "output": "When Application.ReadWrite.All abuse fails, enumerate alternative paths: 1) Check for other high-privilege applications/service principals. 2) Look for group memberships that might provide indirect access. 3) Review custom roles for overlooked permissions. 4) Check PIM (Privileged Identity Management) for eligible role activations. The original technique (Azure AD Privilege Escalation via App Registration) failing suggests monitoring may be in place - adjust operational tempo."}
{"instruction": "You are conducting a cloud penetration test against an Azure/Entra ID environment.", "input": "Scenario: Access to Azure VM with managed identity. Considering IMDS exploitation on Azure VMs. What's your approach?", "output": "Query the Instance Metadata Service (169.254.169.254) to obtain access tokens for the VM's managed identity. Works for both system-assigned and user-assigned identities. Token is valid for downstream Azure resource access. Detection: IMDS queries are not logged - this is relatively stealthy. However, subsequent API calls using the token are logged. Enumerate identity permissions with az role assignment list before taking high-visibility actions."}
{"instruction": "Your attempt at Managed Identity Token Theft in Azure failed due to insufficient permissions.", "input": "Need to find alternative escalation path. What do you check next?", "output": "When IMDS exploitation on Azure VMs fails, enumerate alternative paths: 1) Check for other high-privilege applications/service principals. 2) Look for group memberships that might provide indirect access. 3) Review custom roles for overlooked permissions. 4) Check PIM (Privileged Identity Management) for eligible role activations. The original technique (Managed Identity Token Theft) failing suggests monitoring may be in place - adjust operational tempo."}
{"instruction": "You are conducting a cloud penetration test against an Azure/Entra ID environment.", "input": "Scenario: Has Get/List permissions on Key Vault. Considering Key Vault access policy abuse. What's your approach?", "output": "Extract secrets, keys, and certificates from Azure Key Vault. Common targets: storage account keys, database connection strings, service principal credentials. Detection: Key Vault has detailed diagnostic logging if enabled. Check vault access policies for overly permissive configurations. Soft-delete recovery: Deleted secrets can often be recovered if soft-delete is enabled and purge protection is off."}
{"instruction": "Your attempt at Azure Key Vault Extraction in Azure failed due to insufficient permissions.", "input": "Need to find alternative escalation path. What do you check next?", "output": "When Key Vault access policy abuse fails, enumerate alternative paths: 1) Check for other high-privilege applications/service principals. 2) Look for group memberships that might provide indirect access. 3) Review custom roles for overlooked permissions. 4) Check PIM (Privileged Identity Management) for eligible role activations. The original technique (Azure Key Vault Extraction) failing suggests monitoring may be in place - adjust operational tempo."}
{"instruction": "You are conducting a cloud penetration test against an Azure/Entra ID environment.", "input": "Scenario: Can add credentials to service principals. Considering microsoft.directory/servicePrincipals/credentials/update. What's your approach?", "output": "Add new client secret or certificate to existing service principal. Provides persistent access as that service principal. Target service principals with high-privilege role assignments or API permissions. Detection: Credential additions are logged in audit logs. Stealth: Add certificate-based credential rather than client secret - less commonly monitored. Set long expiration to maintain persistence."}
{"instruction": "Your attempt at Service Principal Credential Addition in Azure failed due to insufficient permissions.", "input": "Need to find alternative escalation path. What do you check next?", "output": "When microsoft.directory/servicePrincipals/credentials/update fails, enumerate alternative paths: 1) Check for other high-privilege applications/service principals. 2) Look for group memberships that might provide indirect access. 3) Review custom roles for overlooked permissions. 4) Check PIM (Privileged Identity Management) for eligible role activations. The original technique (Service Principal Credential Addition) failing suggests monitoring may be in place - adjust operational tempo."}
{"instruction": "You are conducting a cloud penetration test against an Azure/Entra ID environment.", "input": "Scenario: Can create role assignments. Considering Microsoft.Authorization/roleAssignments/write. What's your approach?", "output": "Assign privileged roles (Owner, Contributor, User Access Administrator) to controlled identities. Can be done at subscription, resource group, or resource scope. Detection: Role assignment changes are logged and often alerted on. Stealth approach: Assign roles at resource level rather than subscription level to reduce visibility. Target custom roles that may have privileged permissions but less monitoring."}
{"instruction": "Your attempt at Azure Resource Manager Role Assignment in Azure failed due to insufficient permissions.", "input": "Need to find alternative escalation path. What do you check next?", "output": "When Microsoft.Authorization/roleAssignments/write fails, enumerate alternative paths: 1) Check for other high-privilege applications/service principals. 2) Look for group memberships that might provide indirect access. 3) Review custom roles for overlooked permissions. 4) Check PIM (Privileged Identity Management) for eligible role activations. The original technique (Azure Resource Manager Role Assignment) failing suggests monitoring may be in place - adjust operational tempo."}
{"instruction": "You are conducting a cloud penetration test against an Azure/Entra ID environment.", "input": "Scenario: Access to Automation Account. Considering Automation Account with Run As Account. What's your approach?", "output": "Execute PowerShell/Python runbooks using the Automation Account's Run As Account (service principal). Runbooks can perform actions with the service principal's permissions. Detection: Runbook executions are logged in job history. Stealth: Modify existing runbooks rather than creating new ones. Use hybrid workers if available to execute outside Azure."}
{"instruction": "Your attempt at Azure Automation Runbook Execution in Azure failed due to insufficient permissions.", "input": "Need to find alternative escalation path. What do you check next?", "output": "When Automation Account with Run As Account fails, enumerate alternative paths: 1) Check for other high-privilege applications/service principals. 2) Look for group memberships that might provide indirect access. 3) Review custom roles for overlooked permissions. 4) Check PIM (Privileged Identity Management) for eligible role activations. The original technique (Azure Automation Runbook Execution) failing suggests monitoring may be in place - adjust operational tempo."}
{"instruction": "You are conducting a cloud penetration test against an Azure/Entra ID environment.", "input": "Scenario: Conditional Access policies restrict access. Considering Policy analysis and evasion. What's your approach?", "output": "Analyze CA policies for gaps: legacy authentication exclusions, location-based exclusions, device trust bypasses. Legacy protocols (IMAP, SMTP, POP3) often bypass modern CA policies. Test from excluded locations or using excluded applications. Detection: Sign-in logs show CA policy evaluation results. Stealth is difficult - focus on finding legitimate exclusions rather than bypassing."}
{"instruction": "Your attempt at Conditional Access Policy Bypass in Azure failed due to insufficient permissions.", "input": "Need to find alternative escalation path. What do you check next?", "output": "When Policy analysis and evasion fails, enumerate alternative paths: 1) Check for other high-privilege applications/service principals. 2) Look for group memberships that might provide indirect access. 3) Review custom roles for overlooked permissions. 4) Check PIM (Privileged Identity Management) for eligible role activations. The original technique (Conditional Access Policy Bypass) failing suggests monitoring may be in place - adjust operational tempo."}
{"instruction": "You are conducting a cloud penetration test against an Azure/Entra ID environment.", "input": "Scenario: Access to Azure AD Connect server. Considering AD Connect server compromise. What's your approach?", "output": "Azure AD Connect server contains credentials for directory synchronization. AADInternals module can extract sync credentials. Provides ability to modify on-prem objects that sync to Azure AD. Detection: Requires local admin on AD Connect server - initial access is the challenge. Once on the server, extraction is difficult to detect. Consider DPAPI extraction and credential file access. High-value target for hybrid environment compromise."}
{"instruction": "Your attempt at Azure AD Connect Password Extraction in Azure failed due to insufficient permissions.", "input": "Need to find alternative escalation path. What do you check next?", "output": "When AD Connect server compromise fails, enumerate alternative paths: 1) Check for other high-privilege applications/service principals. 2) Look for group memberships that might provide indirect access. 3) Review custom roles for overlooked permissions. 4) Check PIM (Privileged Identity Management) for eligible role activations. The original technique (Azure AD Connect Password Extraction) failing suggests monitoring may be in place - adjust operational tempo."}
{"instruction": "You are conducting a cloud penetration test against a GCP environment.", "input": "Scenario: Can create keys for service accounts. Technique available: iam.serviceAccountKeys.create. Analysis?", "output": "Create a new key for an existing service account to obtain persistent credentials. Target service accounts with project-level Editor/Owner roles. Detection: Service account key creation is logged in Cloud Audit Logs. Keys created but not associated with legitimate automation are suspicious. Stealth: Target service accounts that already have multiple keys - one more is less noticeable."}
{"instruction": "You are conducting a cloud penetration test against a GCP environment.", "input": "Scenario: Can modify VM service account. Technique available: compute.instances.setServiceAccount. Analysis?", "output": "Change the service account attached to a Compute Engine instance to one with higher privileges. Requires compute.instances.setServiceAccount and iam.serviceAccounts.actAs on target service account. Restart required for change to take effect. Detection: Instance metadata modification is logged. Alternative: If you have setMetadata permission, add SSH keys to gain instance access without changing service account."}
{"instruction": "You are conducting a cloud penetration test against a GCP environment.", "input": "Scenario: Can create Cloud Functions with service accounts. Technique available: cloudfunctions.functions.create + iam.serviceAccounts.actAs. Analysis?", "output": "Create a Cloud Function that runs with a privileged service account. Function code executes with the service account's permissions. Detection: Function creation is logged. Stealth: Use existing function names/patterns that match legitimate deployment. Consider Cloud Run as alternative if Functions are more heavily monitored."}
{"instruction": "You are conducting a cloud penetration test against a GCP environment.", "input": "Scenario: Can modify project IAM policy. Technique available: resourcemanager.projects.setIamPolicy. Analysis?", "output": "Add IAM policy binding granting privileged roles to controlled identity. Can grant roles at project, folder, or organization level depending on permissions. Detection: IAM policy changes are logged and typically alerted on. Stealth: Grant predefined roles rather than primitive roles (roles/viewer vs roles/editor). Consider granting on specific resources rather than project-wide."}
{"instruction": "You are conducting a cloud penetration test against a GCP environment.", "input": "Scenario: Can modify bucket IAM policies. Technique available: storage.buckets.setIamPolicy. Analysis?", "output": "Modify bucket IAM policy to grant access to controlled identity or allUsers. Common misconfiguration target for data exfiltration. Detection: Bucket policy changes are logged. Public bucket access triggers additional alerts in many configurations. Stealth: Grant access to specific service account rather than broad access. Consider signed URLs for temporary access that doesn't modify policies."}
{"instruction": "You are conducting a cloud penetration test against a GCP environment.", "input": "Scenario: Access to Compute Engine instance. Technique available: GCE metadata service abuse. Analysis?", "output": "Query metadata server at http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token to obtain access token for instance's service account. Works for any GCE instance with attached service account. Detection: Metadata queries are not externally logged. Token use is logged based on API calls. Enumerate scopes at metadata endpoint before using token to understand available permissions."}
{"instruction": "You are conducting a cloud penetration test against a GCP environment.", "input": "Scenario: Target resources protected by VPC-SC. Technique available: Authorized network/identity abuse. Analysis?", "output": "VPC Service Controls create perimeters around sensitive resources. Bypass techniques: compromise authorized identities, use authorized networks, exploit ingress/egress rules. Access context levels may allow bypass based on device state or IP. Detection: VPC-SC violations are logged as audit logs. Finding authorized entry points requires enumeration of perimeter configuration."}
{"instruction": "You are conducting a cloud penetration test against a GCP environment.", "input": "Scenario: GCP trusts external IdP. Technique available: External identity provider trust. Analysis?", "output": "If GCP workload identity federation trusts an external identity provider (AWS, Azure AD, OIDC), compromise of external identity can lead to GCP access. Enumerate workload identity pools and their provider configurations. Target: Service accounts that trust external identities. Detection: Token exchange is logged. Useful for cross-cloud lateral movement."}
{"instruction": "You are testing an AWS environment with CloudTrail and GuardDuty enabled.", "input": "Need to enumerate IAM permissions without triggering alerts. Current user has basic read access.", "output": "GuardDuty detects reconnaissance patterns and anomalous API behavior. Approach: 1) Use sts:GetCallerIdentity first - this is expected and establishes baseline. 2) Enumerate slowly with delays between API calls. 3) Focus on specific services rather than broad enumeration - targeted iam:ListAttachedUserPolicies on your own user is less suspicious than iam:ListUsers. 4) Avoid pacu/ScoutSuite signatures - use AWS CLI directly. 5) Check CloudTrail configuration with cloudtrail:DescribeTrails to understand logging coverage. Detection risk: Medium if slow and targeted. High if using automated enumeration tools."}
{"instruction": "Azure environment has Conditional Access policies requiring compliant devices and MFA.", "input": "Have valid credentials but failing CA policy evaluation. Need to gain access.", "output": "CA policy bypass strategies: 1) Check for legacy authentication exclusions - protocols like IMAP/SMTP often bypass modern policies. Test with basic auth against Exchange Online. 2) Analyze policy details via Graph API if you have AuditLog.Read.All. 3) Look for service principal credentials - SP authentication often has fewer CA restrictions. 4) Check for B2B/guest account policies - different CA policies may apply. 5) If device compliance required, check for hybrid join misconfiguration allowing any domain-joined device. Detection risk: Failed CA evaluations are logged. Multiple failures increase suspicion. Stealth approach: Analyze policies before attempting access."}
{"instruction": "GCP environment uses Organization Policy constraints restricting external IP addresses on VMs.", "input": "Need to establish C2 channel from compromised VM without external IP.", "output": "Egress without external IP: 1) Cloud NAT - check if configured for the VPC. VMs can reach internet through NAT gateway. 2) Private Google Access - can reach Google APIs including Cloud Functions for data staging. 3) VPC peering - check for peered networks that might have less restrictive egress. 4) Internal load balancer with external backend - unusual but possible. 5) Cloud Interconnect/VPN - check for on-prem connectivity that might provide egress. 6) Use GCP APIs as C2 channel - store commands in GCS bucket, results in Pub/Sub. Detection risk: Unusual egress patterns are detectable. Using native GCP services is stealthier than external C2."}
{"instruction": "Multi-cloud environment with AWS, Azure, and GCP. Need to plan lateral movement approach.", "input": "Initial access to AWS with IAM user credentials. Observed cross-cloud trusts in use.", "output": "Cross-cloud lateral movement strategy: 1) In AWS, enumerate roles with external trust policies - look for sts:AssumeRoleWithWebIdentity configurations trusting Azure AD or external OIDC. 2) Check for AWS credentials stored in Azure Key Vault or GCP Secret Manager via cross-cloud integrations. 3) Look for federated identity configurations - Azure AD applications with AWS role trust, GCP Workload Identity Federation. 4) CI/CD pipelines often have multi-cloud credentials - check CodePipeline, Azure DevOps, or Cloud Build for stored secrets. 5) Infrastructure-as-code repos may contain credentials for multiple clouds. Detection risk varies by cloud - focus on least-monitored environment for pivot. Priority: Find identity federation trust relationships that provide seamless cross-cloud access."}
