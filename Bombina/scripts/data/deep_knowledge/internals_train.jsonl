{"instruction": "Explain Linux Filesystem Security for offensive security", "input": "Topic: Linux Filesystem Security. Attack relevance: Privilege escalation, data access, persistence.", "output": "## Linux Internals: Linux Filesystem Security\n\n### Overview\nFile permissions, ACLs, and filesystem attacks\n\n### Attack Relevance\n**Privilege escalation, data access, persistence**\n\n### Deep Technical Dive\nFilesystem security is foundational:\n\n**Permission Model**:\n- Traditional: Owner/group/other, rwx\n- ACLs: Extended access control lists\n- Extended attributes: Security labels, capabilities\n- File capabilities: setcap for fine-grained privilege\n\n**Special Files**:\n- Setuid/setgid: Execute with owner/group privileges\n- World-writable: /tmp, /var/tmp risks\n- Symlinks: Can be used for attacks\n- Device files: Hardware access\n\n**Attack Vectors**:\n1. Path traversal: Access unintended files\n2. Symlink attacks: Race conditions, redirects\n3. Permission issues: World-writable configs\n4. File capability abuse: Binaries with capabilities\n\n**Innovation Vectors**:\n- New path traversal contexts\n- Symlink race conditions\n- Mount namespace abuse\n- Overlay filesystem attacks\n\n### Practical Application\n\n**Enumeration**:\n- What reveals this attack surface?\n- Key files, commands, APIs to check?\n- Indicators of vulnerability?\n\n**Exploitation**:\n- Common tools and techniques?\n- Manual exploitation steps?\n- Reliability considerations?\n\n**Post-Exploitation**:\n- What does success provide?\n- How to persist?\n- Next steps?\n\n### Building Expertise\n\nTo master linux filesystem security:\n1. Study Linux source code and documentation\n2. Practice on intentionally vulnerable systems\n3. Use debugging and tracing tools\n4. Study published exploits\n5. Develop custom techniques", "category": "linux_internals"}
{"instruction": "Explain Windows Networking Stack for offensive security", "input": "Topic: Windows Networking Stack. Attack relevance: Network attacks, MITM, protocol exploitation.", "output": "## Windows Internals: Windows Networking Stack\n\n### Overview\nHow Windows handles network protocols\n\n### Attack Relevance\n**Network attacks, MITM, protocol exploitation**\n\n### Deep Technical Dive\nWindows networking is complex and attackable:\n\n**Protocol Stack**:\n- SMB/CIFS: File sharing (port 445)\n- NetBIOS: Name resolution (137-139)\n- LLMNR/NBT-NS/mDNS: Local name resolution\n- Kerberos: Domain authentication (88)\n- LDAP: Directory access (389/636)\n\n**Attack Surface**:\n- Name resolution poisoning: LLMNR/NBT-NS/mDNS\n- Relay attacks: SMB/HTTP \u2192 LDAP/SMB/etc\n- Protocol vulnerabilities: EternalBlue, etc\n- Coercion: Force outbound authentication\n\n**Attack Approaches**:\n1. Responder: Poison name resolution, capture hashes\n2. ntlmrelayx: Relay captured authentication\n3. SMB attacks: Exploits, signing bypass, capture\n4. Kerberos attacks: Roasting, delegation abuse\n\n**Innovation Vectors**:\n- New coercion triggers\n- Novel relay chains\n- Cross-protocol attacks\n- Protocol implementation bugs\n\n### Practical Application\n\n**Reconnaissance**:\n- What information reveals this attack surface?\n- How to enumerate configuration?\n- What indicates vulnerability?\n\n**Exploitation**:\n- What tools exist for this attack?\n- What custom techniques are needed?\n- How to achieve reliable exploitation?\n\n**Post-Exploitation**:\n- What capabilities does this provide?\n- How to maintain access?\n- What to look for next?\n\n### Building Expertise\n\nTo master windows networking stack:\n1. Study Windows documentation and internals books\n2. Use debugging tools (WinDbg, Process Monitor)\n3. Practice on lab systems\n4. Study existing tools and exploits\n5. Develop custom techniques", "category": "windows_internals"}
{"instruction": "Explain HTTP Protocol Deep Dive for web application attacks", "input": "Components: Request/Response structure, Headers, Methods. Attack surface: Request smuggling, header injection, method confusion, keep-alive abuse.", "output": "## Web Internals: HTTP Protocol Deep Dive\n\n### Components\n- **Request/Response structure**\n- **Headers**\n- **Methods**\n- **Status codes**\n- **Connections**\n\n### Attack Surface\nRequest smuggling, header injection, method confusion, keep-alive abuse\n\n### Deep Technical Knowledge\nHTTP is the foundation of web attacks:\n\n**Request Structure**:\n```\nMETHOD /path?query HTTP/1.1\nHost: target.com\nHeader: Value\n\nBody\n```\n\n**Critical Headers for Attacks**:\n- Host: Virtual host routing, SSRF\n- Content-Length/Transfer-Encoding: Smuggling\n- Cookie: Session hijacking\n- Authorization: Token theft\n- X-Forwarded-*: Trust boundary confusion\n\n**HTTP/1.1 vs HTTP/2 vs HTTP/3**:\n- H1: Text-based, keep-alive, pipelining\n- H2: Binary, multiplexed streams, HPACK compression\n- H3: QUIC-based, UDP, QPACK compression\n\n**Attack Patterns**:\n1. Smuggling: CL/TE desync between servers\n2. Header injection: CRLF to inject headers\n3. Host header attacks: Routing manipulation\n4. Method override: X-HTTP-Method-Override abuse\n\n### Exploitation Approach\n\n**Reconnaissance**:\n- Identify technology stack\n- Enumerate configuration\n- Find misconfigurations\n\n**Vulnerability Discovery**:\n- Test each component for issues\n- Look for known CVEs\n- Custom fuzzing\n\n**Exploitation**:\n- Develop working exploit\n- Chain vulnerabilities\n- Achieve impact\n\n### Innovation Opportunities\n\nTo find new vulnerabilities in this area:\n1. Study framework/protocol source code\n2. Compare implementations\n3. Test edge cases\n4. Look for composition issues\n5. Analyze recent CVEs", "category": "web_internals"}
{"instruction": "Explain Windows RPC and DCOM for offensive security", "input": "Topic: Windows RPC and DCOM. Attack relevance: Remote exploitation, lateral movement, privilege escalation.", "output": "## Windows Internals: Windows RPC and DCOM\n\n### Overview\nRemote procedure calls and distributed COM\n\n### Attack Relevance\n**Remote exploitation, lateral movement, privilege escalation**\n\n### Deep Technical Dive\nRPC/DCOM enables Windows remote communication:\n\n**Architecture**:\n- MSRPC: Microsoft's DCE-RPC implementation\n- DCOM: COM over network\n- NDR: Network Data Representation (marshaling)\n- Interfaces: Defined by UUID and version\n\n**Exposed Attack Surface**:\n- Anonymous access: Some interfaces accessible unauthenticated\n- Privileged operations: Many run as SYSTEM\n- Complex parsing: NDR deserialization bugs\n- Trust confusion: Client/server trust issues\n\n**Attack Approaches**:\n1. Interface enumeration: Find accessible interfaces\n2. Method fuzzing: Test for parsing vulnerabilities\n3. Coercion: Force NTLM authentication\n4. Relay: Relay RPC authentication to other services\n\n**Innovation Vectors**:\n- Undocumented interface discovery\n- New coercion methods (PrintNightmare, etc.)\n- Novel relay scenarios\n- Interface-specific vulnerabilities\n\n### Practical Application\n\n**Reconnaissance**:\n- What information reveals this attack surface?\n- How to enumerate configuration?\n- What indicates vulnerability?\n\n**Exploitation**:\n- What tools exist for this attack?\n- What custom techniques are needed?\n- How to achieve reliable exploitation?\n\n**Post-Exploitation**:\n- What capabilities does this provide?\n- How to maintain access?\n- What to look for next?\n\n### Building Expertise\n\nTo master windows rpc and dcom:\n1. Study Windows documentation and internals books\n2. Use debugging tools (WinDbg, Process Monitor)\n3. Practice on lab systems\n4. Study existing tools and exploits\n5. Develop custom techniques", "category": "windows_internals"}
{"instruction": "Explain Asymmetric Cryptography Attacks for security testing", "input": "Primitives: RSA, ECDSA, Diffie-Hellman", "output": "## Cryptographic Internals: Asymmetric Cryptography Attacks\n\n### Primitives\n- **RSA**\n- **ECDSA**\n- **Diffie-Hellman**\n- **Certificates**\n\n### Known Attacks\nAsymmetric crypto attacks:\n\n**RSA Weaknesses**:\n- Textbook RSA: No padding = malleable\n- PKCS#1 v1.5: Bleichenbacher padding oracle\n- Small exponent: e=3 with small message\n- Common modulus: Shared n between keys\n- Factorization: Weak key generation\n\n**ECDSA Issues**:\n- Nonce reuse: Private key recovery\n- Biased nonce: Lattice attack\n- Invalid curve: Point not on curve\n\n**Certificate Attacks**:\n- Self-signed acceptance\n- Hostname validation bypass\n- Certificate pinning bypass\n- CA compromise implications\n\n### Finding Crypto Vulnerabilities\n\n**Identification**:\n- What crypto is in use?\n- How is it configured?\n- What mode/parameters?\n- How are keys managed?\n\n**Testing**:\n- Check for known weaknesses\n- Test implementation quality\n- Look for side channels\n- Analyze key handling\n\n### Innovation in Crypto Attacks\n\nMost crypto attacks come from:\n1. Implementation errors\n2. Protocol misuse\n3. Side channels\n4. Mathematical advances\n5. Key management failures\n\n### Practical Approach\n\nWhen testing crypto:\n1. Identify what's being used\n2. Check for known issues\n3. Test implementation quality\n4. Look for protocol-level issues\n5. Consider side channels", "category": "crypto_internals"}
{"instruction": "Explain LSASS and Credential Storage for offensive security", "input": "Topic: LSASS and Credential Storage. Attack relevance: Credential dumping, pass-the-hash, mimikatz.", "output": "## Windows Internals: LSASS and Credential Storage\n\n### Overview\nHow Windows stores and protects credentials\n\n### Attack Relevance\n**Credential dumping, pass-the-hash, mimikatz**\n\n### Deep Technical Dive\nLSASS (Local Security Authority Subsystem Service) is the core credential handler:\n\n**Credential Storage Locations**:\n- SAM database: Local accounts (SYSTEM hive protected)\n- LSASS memory: Cached credentials, Kerberos tickets, NTLM hashes\n- Credential Manager: Stored web/domain credentials\n- DPAPI: User data protection (tied to user password)\n\n**Protection Mechanisms**:\n- LSASS runs as Protected Process Light (PPL) on newer systems\n- Credential Guard uses virtualization-based security (VBS)\n- LSA protection prevents unsigned code loading\n- RunAsPPL registry setting\n\n**Attack Approaches**:\n1. Memory access: Read LSASS memory (requires admin + bypass PPL)\n2. SAM extraction: Offline attack on SAM/SYSTEM hives\n3. DCSync: Domain replication to extract hashes\n4. Over-pass-the-hash: Use hash to get Kerberos ticket\n\n**Innovation Vectors**:\n- New PPL bypass techniques\n- Credential Guard escape\n- Novel memory access methods\n- Alternative credential sources\n\n### Practical Application\n\n**Reconnaissance**:\n- What information reveals this attack surface?\n- How to enumerate configuration?\n- What indicates vulnerability?\n\n**Exploitation**:\n- What tools exist for this attack?\n- What custom techniques are needed?\n- How to achieve reliable exploitation?\n\n**Post-Exploitation**:\n- What capabilities does this provide?\n- How to maintain access?\n- What to look for next?\n\n### Building Expertise\n\nTo master lsass and credential storage:\n1. Study Windows documentation and internals books\n2. Use debugging tools (WinDbg, Process Monitor)\n3. Practice on lab systems\n4. Study existing tools and exploits\n5. Develop custom techniques", "category": "windows_internals"}
{"instruction": "Explain Linux Kernel Attack Surface for offensive security", "input": "Topic: Linux Kernel Attack Surface. Attack relevance: Kernel exploitation, container escape, privilege escalation.", "output": "## Linux Internals: Linux Kernel Attack Surface\n\n### Overview\nHow to attack the Linux kernel\n\n### Attack Relevance\n**Kernel exploitation, container escape, privilege escalation**\n\n### Deep Technical Dive\nThe kernel is the ultimate privilege target:\n\n**Attack Surface**:\n- Syscalls: 400+ system calls\n- Device drivers: Huge code base, varying quality\n- Filesystems: Parsing of untrusted data\n- Networking: Protocol handlers\n- eBPF: JIT compilation, verifier\n\n**Vulnerability Types**:\n- Memory corruption in kernel code\n- Race conditions\n- Use-after-free in kernel objects\n- Type confusion\n- Logic bugs\n\n**Exploitation Challenges**:\n- KASLR: Kernel address randomization\n- SMEP/SMAP: Supervisor mode restrictions\n- KPTI: Page table isolation\n- CFI: Control flow integrity\n\n**Attack Approaches**:\n1. Namespace/cgroup escape: Break container isolation\n2. Driver exploitation: Target loaded drivers\n3. Syscall exploitation: Fuzz syscall interfaces\n4. eBPF: JIT bugs, verifier bypasses\n\n**Innovation Vectors**:\n- New kernel primitives\n- Novel KASLR bypasses\n- Container escape techniques\n- eBPF exploitation\n\n### Practical Application\n\n**Enumeration**:\n- What reveals this attack surface?\n- Key files, commands, APIs to check?\n- Indicators of vulnerability?\n\n**Exploitation**:\n- Common tools and techniques?\n- Manual exploitation steps?\n- Reliability considerations?\n\n**Post-Exploitation**:\n- What does success provide?\n- How to persist?\n- Next steps?\n\n### Building Expertise\n\nTo master linux kernel attack surface:\n1. Study Linux source code and documentation\n2. Practice on intentionally vulnerable systems\n3. Use debugging and tracing tools\n4. Study published exploits\n5. Develop custom techniques", "category": "linux_internals"}
{"instruction": "Explain Cloud Metadata Services for cloud attacks", "input": "Attack surface: SSRF to metadata, credential theft, instance identity", "output": "## Cloud Internals: Cloud Metadata Services\n\n### Attack Surface\nSSRF to metadata, credential theft, instance identity\n\n### Deep Technical Details\nMetadata services are high-value targets:\n\n**AWS IMDS**:\n- v1: GET http://169.254.169.254/latest/meta-data/\n- v2: Requires PUT for token first (IMDSv2)\n- Credentials at: /iam/security-credentials/role-name\n\n**Azure IMDS**:\n- http://169.254.169.254/metadata/instance\n- Requires Metadata: true header\n- Managed identity tokens at /identity/oauth2/token\n\n**GCP Metadata**:\n- http://metadata.google.internal/computeMetadata/\n- Requires Metadata-Flavor: Google header\n- Service account tokens available\n\n**Attack Patterns**:\n1. SSRF: Application fetches metadata URL\n2. Container escape: Access node metadata\n3. Cloud function: Lambda/function has role\n4. Credential leakage: Logs, debug endpoints\n\n### Exploitation Methodology\n\n**Enumeration**:\n- What credentials/access do you have?\n- What permissions are granted?\n- What resources exist?\n- What can you reach?\n\n**Privilege Escalation**:\n- What paths lead to higher privileges?\n- What services can be abused?\n- What misconfigurations exist?\n\n**Lateral Movement**:\n- What other resources can be accessed?\n- What trust relationships exist?\n- How to pivot between services?\n\n### Innovation Vectors\n\nNew cloud attacks emerge from:\n1. New service features\n2. Policy complexity\n3. Trust relationship abuse\n4. Cross-service interactions\n5. API quirks", "category": "cloud_internals"}
{"instruction": "Explain Hash and Token Attacks for security testing", "input": "Primitives: MD5, SHA-1, SHA-256", "output": "## Cryptographic Internals: Hash and Token Attacks\n\n### Primitives\n- **MD5**\n- **SHA-1**\n- **SHA-256**\n- **HMAC**\n- **JWT**\n\n### Known Attacks\nHash and token weaknesses:\n\n**Hash Collisions**:\n- MD5: Practical collisions\n- SHA-1: Theoretical breaks\n- Use in: Certificates, signatures, checksums\n\n**Length Extension**:\n- MD5, SHA-1, SHA-256 vulnerable\n- Append data to existing hash\n- Counter: Use HMAC instead\n\n**JWT Attacks**:\n- Algorithm none: No signature required\n- Algorithm confusion: HS256 with RS256 public key\n- Key injection: jwk/jku in header\n- Weak secrets: Brute force HS256\n\n### Finding Crypto Vulnerabilities\n\n**Identification**:\n- What crypto is in use?\n- How is it configured?\n- What mode/parameters?\n- How are keys managed?\n\n**Testing**:\n- Check for known weaknesses\n- Test implementation quality\n- Look for side channels\n- Analyze key handling\n\n### Innovation in Crypto Attacks\n\nMost crypto attacks come from:\n1. Implementation errors\n2. Protocol misuse\n3. Side channels\n4. Mathematical advances\n5. Key management failures\n\n### Practical Approach\n\nWhen testing crypto:\n1. Identify what's being used\n2. Check for known issues\n3. Test implementation quality\n4. Look for protocol-level issues\n5. Consider side channels", "category": "crypto_internals"}
{"instruction": "Explain Linux Privilege Model for offensive security", "input": "Topic: Linux Privilege Model. Attack relevance: Privilege escalation, capability abuse, setuid exploitation.", "output": "## Linux Internals: Linux Privilege Model\n\n### Overview\nUIDs, capabilities, and privilege management\n\n### Attack Relevance\n**Privilege escalation, capability abuse, setuid exploitation**\n\n### Deep Technical Dive\nLinux privilege is more nuanced than just root:\n\n**Identity Model**:\n- Real UID: Actual user\n- Effective UID: Privilege level for access checks\n- Saved UID: Remembered UID for switching\n- File system UID: For file system access\n\n**Capabilities**:\n- Break root into 40+ capabilities\n- CAP_SYS_ADMIN: Catch-all admin capability\n- CAP_NET_RAW: Raw sockets\n- CAP_DAC_OVERRIDE: Bypass file permissions\n- Inherited, permitted, effective, bounding sets\n\n**Attack Vectors**:\n1. Setuid binaries: Execute as owner (often root)\n2. Capability abuse: Leverage granted capabilities\n3. Sudo misconfig: NOPASSWD, env_keep, etc\n4. Polkit/dbus: Privilege escalation via services\n\n**Innovation Vectors**:\n- New setuid vulnerabilities\n- Capability combination attacks\n- Sudo bypass techniques\n- Policy kit exploitation\n\n### Practical Application\n\n**Enumeration**:\n- What reveals this attack surface?\n- Key files, commands, APIs to check?\n- Indicators of vulnerability?\n\n**Exploitation**:\n- Common tools and techniques?\n- Manual exploitation steps?\n- Reliability considerations?\n\n**Post-Exploitation**:\n- What does success provide?\n- How to persist?\n- Next steps?\n\n### Building Expertise\n\nTo master linux privilege model:\n1. Study Linux source code and documentation\n2. Practice on intentionally vulnerable systems\n3. Use debugging and tracing tools\n4. Study published exploits\n5. Develop custom techniques", "category": "linux_internals"}
{"instruction": "Explain Kubernetes Security Model for cloud attacks", "input": "Attack surface: RBAC bypass, container escape, service account abuse, secrets", "output": "## Cloud Internals: Kubernetes Security Model\n\n### Attack Surface\nRBAC bypass, container escape, service account abuse, secrets\n\n### Deep Technical Details\nKubernetes security is complex:\n\n**Authentication**:\n- Service accounts: Pod identity\n- OIDC: External identity providers\n- Certificates: Client certs\n\n**Authorization (RBAC)**:\n- Roles/ClusterRoles: Permissions\n- RoleBindings/ClusterRoleBindings: Assignment\n- Aggregated roles: Combined permissions\n\n**Pod Security**:\n- Security contexts: Container restrictions\n- Pod Security Standards: Privileged/baseline/restricted\n- Network policies: Pod-to-pod communication\n\n**Attack Paths**:\n1. Service account abuse: Mount tokens, enumerate RBAC\n2. Secret access: Read secrets, mount ConfigMaps\n3. Container escape: Kernel exploit, socket access\n4. etcd access: Direct database access\n\n### Exploitation Methodology\n\n**Enumeration**:\n- What credentials/access do you have?\n- What permissions are granted?\n- What resources exist?\n- What can you reach?\n\n**Privilege Escalation**:\n- What paths lead to higher privileges?\n- What services can be abused?\n- What misconfigurations exist?\n\n**Lateral Movement**:\n- What other resources can be accessed?\n- What trust relationships exist?\n- How to pivot between services?\n\n### Innovation Vectors\n\nNew cloud attacks emerge from:\n1. New service features\n2. Policy complexity\n3. Trust relationship abuse\n4. Cross-service interactions\n5. API quirks", "category": "cloud_internals"}
{"instruction": "Explain Symmetric Cryptography Attacks for security testing", "input": "Primitives: AES, Block cipher modes, Stream ciphers", "output": "## Cryptographic Internals: Symmetric Cryptography Attacks\n\n### Primitives\n- **AES**\n- **Block cipher modes**\n- **Stream ciphers**\n- **MACs**\n\n### Known Attacks\nSymmetric crypto attacks:\n\n**Block Cipher Mode Issues**:\n- ECB: Pattern preservation\n- CBC: Padding oracle, IV manipulation\n- CTR: Nonce reuse = keystream recovery\n- GCM: Nonce reuse = authentication bypass\n\n**Padding Oracle**:\n- When server reveals padding validity\n- Byte-by-byte decryption possible\n- Works on CBC mode\n- POODLE, Lucky13, etc.\n\n**Implementation Issues**:\n- Timing attacks on comparison\n- Key management failures\n- IV/nonce reuse\n- Weak random generation\n\n### Finding Crypto Vulnerabilities\n\n**Identification**:\n- What crypto is in use?\n- How is it configured?\n- What mode/parameters?\n- How are keys managed?\n\n**Testing**:\n- Check for known weaknesses\n- Test implementation quality\n- Look for side channels\n- Analyze key handling\n\n### Innovation in Crypto Attacks\n\nMost crypto attacks come from:\n1. Implementation errors\n2. Protocol misuse\n3. Side channels\n4. Mathematical advances\n5. Key management failures\n\n### Practical Approach\n\nWhen testing crypto:\n1. Identify what's being used\n2. Check for known issues\n3. Test implementation quality\n4. Look for protocol-level issues\n5. Consider side channels", "category": "crypto_internals"}
{"instruction": "Explain Windows Service Architecture for offensive security", "input": "Topic: Windows Service Architecture. Attack relevance: Service exploitation, privilege escalation, persistence.", "output": "## Windows Internals: Windows Service Architecture\n\n### Overview\nHow Windows services work and can be abused\n\n### Attack Relevance\n**Service exploitation, privilege escalation, persistence**\n\n### Deep Technical Dive\nWindows services provide persistent, privileged execution:\n\n**Service Components**:\n- SCM (Service Control Manager): Manages all services\n- Service executable: The actual program\n- Service account: Identity service runs as\n- Service configuration: Registry under HKLM\\SYSTEM\\CurrentControlSet\\Services\n\n**Privilege Levels**:\n- LocalSystem: Highest privilege, no network identity\n- LocalService: Limited, anonymous network\n- NetworkService: Limited, machine network identity\n- Domain accounts: Configurable privileges\n\n**Attack Approaches**:\n1. Unquoted service paths: Path traversal in service binaries\n2. Weak permissions: Modify service configuration or binary\n3. DLL hijacking: Missing DLLs in service search path\n4. Service account abuse: Compromise service account credentials\n\n**Innovation Vectors**:\n- New service misconfiguration patterns\n- Service-specific vulnerabilities\n- Novel DLL injection techniques\n- Cross-service attacks\n\n### Practical Application\n\n**Reconnaissance**:\n- What information reveals this attack surface?\n- How to enumerate configuration?\n- What indicates vulnerability?\n\n**Exploitation**:\n- What tools exist for this attack?\n- What custom techniques are needed?\n- How to achieve reliable exploitation?\n\n**Post-Exploitation**:\n- What capabilities does this provide?\n- How to maintain access?\n- What to look for next?\n\n### Building Expertise\n\nTo master windows service architecture:\n1. Study Windows documentation and internals books\n2. Use debugging tools (WinDbg, Process Monitor)\n3. Practice on lab systems\n4. Study existing tools and exploits\n5. Develop custom techniques", "category": "windows_internals"}
{"instruction": "Explain Web Framework Internals for web application attacks", "input": "Components: Routing, Template engines, ORM. Attack surface: SSTI, ORM injection, mass assignment, deserialization.", "output": "## Web Internals: Web Framework Internals\n\n### Components\n- **Routing**\n- **Template engines**\n- **ORM**\n- **Authentication**\n\n### Attack Surface\nSSTI, ORM injection, mass assignment, deserialization\n\n### Deep Technical Knowledge\nFrameworks have common vulnerability patterns:\n\n**Template Engines**:\n- Server-side rendering\n- Expression evaluation\n- SSTI: User input in template = code execution\n- Common: Jinja2, Twig, Freemarker, Velocity\n\n**ORM/Query Builders**:\n- Object-Relational Mapping\n- Can still have injection via:\n  - Raw queries\n  - Unsafe operations\n  - Order by/group by\n\n**Mass Assignment**:\n- Automatic parameter binding to objects\n- Can modify unintended fields\n- Especially dangerous: isAdmin, role, permissions\n\n**Framework-Specific**:\n- Spring: SpEL injection, actuator exposure\n- Django: Admin, debug mode\n- Rails: Mass assignment, YAML deserialization\n- Node/Express: Prototype pollution\n\n### Exploitation Approach\n\n**Reconnaissance**:\n- Identify technology stack\n- Enumerate configuration\n- Find misconfigurations\n\n**Vulnerability Discovery**:\n- Test each component for issues\n- Look for known CVEs\n- Custom fuzzing\n\n**Exploitation**:\n- Develop working exploit\n- Chain vulnerabilities\n- Achieve impact\n\n### Innovation Opportunities\n\nTo find new vulnerabilities in this area:\n1. Study framework/protocol source code\n2. Compare implementations\n3. Test edge cases\n4. Look for composition issues\n5. Analyze recent CVEs", "category": "web_internals"}
{"instruction": "Explain AWS IAM Deep Dive for cloud attacks", "input": "Attack surface: Privilege escalation, policy abuse, role assumption, credential theft", "output": "## Cloud Internals: AWS IAM Deep Dive\n\n### Attack Surface\nPrivilege escalation, policy abuse, role assumption, credential theft\n\n### Deep Technical Details\nIAM is the foundation of AWS security:\n\n**Identity Types**:\n- Users: Long-term credentials\n- Roles: Temporary credentials via assumption\n- Groups: Policy aggregation\n- Service-linked roles: AWS-managed\n\n**Policy Structure**:\n- Effect: Allow/Deny\n- Action: Service:Operation\n- Resource: ARN specification\n- Condition: Context requirements\n\n**Dangerous Permissions**:\n- iam:*: Full IAM control = privilege escalation\n- sts:AssumeRole: Role chaining\n- PassRole: Attach role to services\n- CreateAccessKey: Persist access\n\n**Attack Paths**:\n1. Role chain: Assume role to assume role\n2. Service pivot: Use service role for escalation\n3. Policy manipulation: Modify policies\n4. Credential persistence: Create keys, add users\n\n### Exploitation Methodology\n\n**Enumeration**:\n- What credentials/access do you have?\n- What permissions are granted?\n- What resources exist?\n- What can you reach?\n\n**Privilege Escalation**:\n- What paths lead to higher privileges?\n- What services can be abused?\n- What misconfigurations exist?\n\n**Lateral Movement**:\n- What other resources can be accessed?\n- What trust relationships exist?\n- How to pivot between services?\n\n### Innovation Vectors\n\nNew cloud attacks emerge from:\n1. New service features\n2. Policy complexity\n3. Trust relationship abuse\n4. Cross-service interactions\n5. API quirks", "category": "cloud_internals"}
{"instruction": "Explain Session Management Internals for web application attacks", "input": "Components: Cookies, Tokens, Server-side sessions. Attack surface: Session hijacking, token forgery, fixation, prediction.", "output": "## Web Internals: Session Management Internals\n\n### Components\n- **Cookies**\n- **Tokens**\n- **Server-side sessions**\n- **JWTs**\n\n### Attack Surface\nSession hijacking, token forgery, fixation, prediction\n\n### Deep Technical Knowledge\nSession management is identity for web:\n\n**Cookie Security**:\n- HttpOnly: No JavaScript access (bypass via XSS in other ways)\n- Secure: HTTPS only\n- SameSite: CSRF protection\n- Domain/Path: Scope control\n\n**Token Types**:\n- Session ID: Opaque reference to server state\n- JWT: Self-contained, signed (optional encrypted)\n- OAuth tokens: Access and refresh tokens\n\n**JWT Vulnerabilities**:\n- Algorithm confusion: None, HS256/RS256 mix\n- Key issues: Weak secrets, key exposure\n- Claim manipulation: Sub, exp, aud\n- Implementation bugs\n\n**Attack Approaches**:\n1. Prediction: Weak random generation\n2. Fixation: Force known session\n3. Theft: XSS, network capture\n4. Forgery: Create valid tokens\n\n### Exploitation Approach\n\n**Reconnaissance**:\n- Identify technology stack\n- Enumerate configuration\n- Find misconfigurations\n\n**Vulnerability Discovery**:\n- Test each component for issues\n- Look for known CVEs\n- Custom fuzzing\n\n**Exploitation**:\n- Develop working exploit\n- Chain vulnerabilities\n- Achieve impact\n\n### Innovation Opportunities\n\nTo find new vulnerabilities in this area:\n1. Study framework/protocol source code\n2. Compare implementations\n3. Test edge cases\n4. Look for composition issues\n5. Analyze recent CVEs", "category": "web_internals"}
{"instruction": "Explain Windows Access Tokens for offensive security", "input": "Topic: Windows Access Tokens. Attack relevance: Token impersonation, privilege escalation, UAC bypass.", "output": "## Windows Internals: Windows Access Tokens\n\n### Overview\nHow Windows tracks identity and privileges\n\n### Attack Relevance\n**Token impersonation, privilege escalation, UAC bypass**\n\n### Deep Technical Dive\nAccess tokens are the core identity mechanism in Windows:\n\n**Token Structure**:\n- User SID: Identity\n- Group SIDs: Group memberships\n- Privileges: What the token can do (SeDebugPrivilege, etc.)\n- Integrity Level: Untrusted/Low/Medium/High/System\n- Token Type: Primary (process) or Impersonation (thread)\n\n**Token Operations**:\n- CreateProcessAsUser: Run as different user\n- ImpersonateLoggedOnUser: Take another user's identity\n- DuplicateToken: Copy and modify tokens\n- SetThreadToken: Change thread identity\n\n**Attack Approaches**:\n1. Token theft: Steal token from another process\n2. Token impersonation: Use stolen token to act as user\n3. Privilege enabling: Enable disabled privileges\n4. Integrity manipulation: Elevate from medium to high\n\n**Innovation Vectors**:\n- New token theft techniques\n- Novel privilege abuse\n- Integrity level manipulation\n- Cross-session token attacks\n\n### Practical Application\n\n**Reconnaissance**:\n- What information reveals this attack surface?\n- How to enumerate configuration?\n- What indicates vulnerability?\n\n**Exploitation**:\n- What tools exist for this attack?\n- What custom techniques are needed?\n- How to achieve reliable exploitation?\n\n**Post-Exploitation**:\n- What capabilities does this provide?\n- How to maintain access?\n- What to look for next?\n\n### Building Expertise\n\nTo master windows access tokens:\n1. Study Windows documentation and internals books\n2. Use debugging tools (WinDbg, Process Monitor)\n3. Practice on lab systems\n4. Study existing tools and exploits\n5. Develop custom techniques", "category": "windows_internals"}
{"instruction": "Explain Browser Security Model for web application attacks", "input": "Components: Same-Origin Policy, CORS, CSP. Attack surface: XSS, CSRF, clickjacking, SOP bypass, CSP bypass.", "output": "## Web Internals: Browser Security Model\n\n### Components\n- **Same-Origin Policy**\n- **CORS**\n- **CSP**\n- **Sandboxing**\n\n### Attack Surface\nXSS, CSRF, clickjacking, SOP bypass, CSP bypass\n\n### Deep Technical Knowledge\nBrowsers are security boundaries:\n\n**Same-Origin Policy**:\n- Origin = scheme + host + port\n- Restricts cross-origin data access\n- Applies to: DOM, cookies, storage, requests\n\n**CORS (Cross-Origin Resource Sharing)**:\n- Relaxes SOP for legitimate use cases\n- Misconfig: Access-Control-Allow-Origin: *\n- Credential issues: Access-Control-Allow-Credentials\n- Preflight: OPTIONS request for complex cases\n\n**CSP (Content Security Policy)**:\n- Controls resource loading\n- XSS mitigation\n- Bypasses: Unsafe-inline, unsafe-eval, JSONP, CDN\n\n**Attack Approaches**:\n1. XSS: Execute arbitrary JavaScript\n2. CSRF: Force authenticated actions\n3. CSP bypass: Find allowed vectors\n4. Clickjacking: UI redressing\n\n### Exploitation Approach\n\n**Reconnaissance**:\n- Identify technology stack\n- Enumerate configuration\n- Find misconfigurations\n\n**Vulnerability Discovery**:\n- Test each component for issues\n- Look for known CVEs\n- Custom fuzzing\n\n**Exploitation**:\n- Develop working exploit\n- Chain vulnerabilities\n- Achieve impact\n\n### Innovation Opportunities\n\nTo find new vulnerabilities in this area:\n1. Study framework/protocol source code\n2. Compare implementations\n3. Test edge cases\n4. Look for composition issues\n5. Analyze recent CVEs", "category": "web_internals"}
