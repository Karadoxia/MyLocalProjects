{"instruction": "Explain how to detect this attack technique from a blue team perspective, and how red teamers can use this knowledge.", "input": "Attack Technique: Pass-the-Hash", "output": "Blue Team Analysis: Detecting Pass-the-Hash\n\n[ATTACK OVERVIEW]\nPass-the-Hash is a common technique used by attackers for credential access/lateral movement.\n\n[DETECTION INDICATORS]\n- Event ID 4624 Type 3 with NTLM\n- Same hash from different IPs\n- Unusual workstation-to-workstation authentication\n\n[DETECTION ENGINEERING]\nSample Detection Query:\n```\nSecurityEvent | where EventID == 4624 and LogonType == 3 | where AuthenticationPackageName == 'NTLM'\n```\n\nAlert Logic:\n- Trigger: Match on indicators above\n- Severity: High\n- Response: Automated ticket creation, analyst investigation required\n\n[MITIGATION RECOMMENDATIONS]\n- Credential Guard\n- LAPS deployment\n- Restrict NTLM usage\n\n[INCIDENT RESPONSE]\nIf Pass-the-Hash is detected:\n1. Isolate affected systems immediately\n2. Dump memory for forensic analysis\n3. Reset affected credentials\n4. Review logs for scope of compromise\n5. Hunt for persistence mechanisms\n\n[RED TEAM AWARENESS]\nAs a pentester, knowing these detections helps you:\n- Understand what blue teams are looking for\n- Modify techniques to reduce detection probability\n- Document which controls successfully detect your activities\n- Recommend specific improvements in your report"}
{"instruction": "Explain how to detect this attack technique from a blue team perspective, and how red teamers can use this knowledge.", "input": "Attack Technique: Kerberoasting", "output": "Blue Team Analysis: Detecting Kerberoasting\n\n[ATTACK OVERVIEW]\nKerberoasting is a common technique used by attackers for credential access/lateral movement.\n\n[DETECTION INDICATORS]\n- Event ID 4769 with RC4 encryption\n- Mass TGS requests in short time\n- Unusual service ticket requests\n\n[DETECTION ENGINEERING]\nSample Detection Query:\n```\nSecurityEvent | where EventID == 4769 and TicketEncryptionType == 0x17 | summarize count() by TargetUserName\n```\n\nAlert Logic:\n- Trigger: Match on indicators above\n- Severity: High\n- Response: Automated ticket creation, analyst investigation required\n\n[MITIGATION RECOMMENDATIONS]\n- AES-only Kerberos\n- Long random SPN passwords\n- gMSA for service accounts\n\n[INCIDENT RESPONSE]\nIf Kerberoasting is detected:\n1. Isolate affected systems immediately\n2. Dump memory for forensic analysis\n3. Reset affected credentials\n4. Review logs for scope of compromise\n5. Hunt for persistence mechanisms\n\n[RED TEAM AWARENESS]\nAs a pentester, knowing these detections helps you:\n- Understand what blue teams are looking for\n- Modify techniques to reduce detection probability\n- Document which controls successfully detect your activities\n- Recommend specific improvements in your report"}
{"instruction": "Explain how to detect this attack technique from a blue team perspective, and how red teamers can use this knowledge.", "input": "Attack Technique: DCSync", "output": "Blue Team Analysis: Detecting DCSync\n\n[ATTACK OVERVIEW]\nDCSync is a common technique used by attackers for credential access/lateral movement.\n\n[DETECTION INDICATORS]\n- Event ID 4662 with GUID for GetChanges\n- Non-DC requesting replication\n- DS-Replication-Get-Changes extended right\n\n[DETECTION ENGINEERING]\nSample Detection Query:\n```\nSecurityEvent | where EventID == 4662 and ObjectType contains 'DS-Replication-Get-Changes'\n```\n\nAlert Logic:\n- Trigger: Match on indicators above\n- Severity: High\n- Response: Automated ticket creation, analyst investigation required\n\n[MITIGATION RECOMMENDATIONS]\n- Monitor for non-DC replication\n- AdminSDHolder protection\n- Limit DA group membership\n\n[INCIDENT RESPONSE]\nIf DCSync is detected:\n1. Isolate affected systems immediately\n2. Dump memory for forensic analysis\n3. Reset affected credentials\n4. Review logs for scope of compromise\n5. Hunt for persistence mechanisms\n\n[RED TEAM AWARENESS]\nAs a pentester, knowing these detections helps you:\n- Understand what blue teams are looking for\n- Modify techniques to reduce detection probability\n- Document which controls successfully detect your activities\n- Recommend specific improvements in your report"}
{"instruction": "Explain how to detect this attack technique from a blue team perspective, and how red teamers can use this knowledge.", "input": "Attack Technique: Golden Ticket", "output": "Blue Team Analysis: Detecting Golden Ticket\n\n[ATTACK OVERVIEW]\nGolden Ticket is a common technique used by attackers for credential access/lateral movement.\n\n[DETECTION INDICATORS]\n- TGT with abnormal lifetime\n- No corresponding AS-REQ\n- Event ID 4769 without 4768\n\n[DETECTION ENGINEERING]\nSample Detection Query:\n```\nCheck for TGT without preceding AS-REQ in authentication logs\n```\n\nAlert Logic:\n- Trigger: Match on indicators above\n- Severity: High\n- Response: Automated ticket creation, analyst investigation required\n\n[MITIGATION RECOMMENDATIONS]\n- Reset KRBTGT password twice\n- Monitor for impossible TGT lifetimes\n- Enable AES Kerberos\n\n[INCIDENT RESPONSE]\nIf Golden Ticket is detected:\n1. Isolate affected systems immediately\n2. Dump memory for forensic analysis\n3. Reset affected credentials\n4. Review logs for scope of compromise\n5. Hunt for persistence mechanisms\n\n[RED TEAM AWARENESS]\nAs a pentester, knowing these detections helps you:\n- Understand what blue teams are looking for\n- Modify techniques to reduce detection probability\n- Document which controls successfully detect your activities\n- Recommend specific improvements in your report"}
{"instruction": "Explain how to detect this attack technique from a blue team perspective, and how red teamers can use this knowledge.", "input": "Attack Technique: Lateral Movement via WMI", "output": "Blue Team Analysis: Detecting Lateral Movement via WMI\n\n[ATTACK OVERVIEW]\nLateral Movement via WMI is a common technique used by attackers for credential access/lateral movement.\n\n[DETECTION INDICATORS]\n- Event ID 5857 (WMI activity)\n- WmiPrvSE.exe spawning child processes\n- Remote WMI connections\n\n[DETECTION ENGINEERING]\nSample Detection Query:\n```\nProcess creation events where parent is WmiPrvSE.exe\n```\n\nAlert Logic:\n- Trigger: Match on indicators above\n- Severity: High\n- Response: Automated ticket creation, analyst investigation required\n\n[MITIGATION RECOMMENDATIONS]\n- Restrict WMI namespaces\n- Monitor WMI subscriptions\n- Network segmentation\n\n[INCIDENT RESPONSE]\nIf Lateral Movement via WMI is detected:\n1. Isolate affected systems immediately\n2. Dump memory for forensic analysis\n3. Reset affected credentials\n4. Review logs for scope of compromise\n5. Hunt for persistence mechanisms\n\n[RED TEAM AWARENESS]\nAs a pentester, knowing these detections helps you:\n- Understand what blue teams are looking for\n- Modify techniques to reduce detection probability\n- Document which controls successfully detect your activities\n- Recommend specific improvements in your report"}
{"instruction": "Explain how to detect this attack technique from a blue team perspective, and how red teamers can use this knowledge.", "input": "Attack Technique: Cobalt Strike Beacon", "output": "Blue Team Analysis: Detecting Cobalt Strike Beacon\n\n[ATTACK OVERVIEW]\nCobalt Strike Beacon is a common technique used by attackers for credential access/lateral movement.\n\n[DETECTION INDICATORS]\n- Beaconing traffic patterns\n- Named pipes (default \\\\pipe\\)\n- Malleable C2 metadata\n\n[DETECTION ENGINEERING]\nSample Detection Query:\n```\nNetFlow analysis for regular interval callbacks to same destination\n```\n\nAlert Logic:\n- Trigger: Match on indicators above\n- Severity: High\n- Response: Automated ticket creation, analyst investigation required\n\n[MITIGATION RECOMMENDATIONS]\n- Network traffic analysis\n- Named pipe monitoring\n- Memory scanning\n\n[INCIDENT RESPONSE]\nIf Cobalt Strike Beacon is detected:\n1. Isolate affected systems immediately\n2. Dump memory for forensic analysis\n3. Reset affected credentials\n4. Review logs for scope of compromise\n5. Hunt for persistence mechanisms\n\n[RED TEAM AWARENESS]\nAs a pentester, knowing these detections helps you:\n- Understand what blue teams are looking for\n- Modify techniques to reduce detection probability\n- Document which controls successfully detect your activities\n- Recommend specific improvements in your report"}
