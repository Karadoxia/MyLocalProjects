{"instruction": "Explain what Pass the Hash is and how it works.", "input": "I need to understand Pass the Hash for penetration testing.", "output": "Pass the Hash (PtH) is an attack technique where an attacker uses the NTLM hash of a user's password instead of the plaintext password to authenticate.\n\n[HOW IT WORKS]\n1. Attacker compromises a system and extracts NTLM hashes\n2. Using tools like Mimikatz, the hash is injected into a new logon session\n3. The attacker can authenticate to other systems without knowing the actual password\n\n[REQUIREMENTS]\n- NTLM hash of target user\n- Target must accept NTLM authentication\n- Network access to target system\n\n[TOOLS]\n- Mimikatz: sekurlsa::pth\n- Impacket: psexec.py -hashes\n- CrackMapExec: cme smb -H\n\n[DETECTION]\n- Event ID 4624 with LogonType 3 or 9\n- Network logons from unexpected sources\n- NTLM authentication when Kerberos expected\n\n[MITIGATION]\n- Credential Guard on Windows 10+\n- Protected Users security group\n- Restrict NTLM usage\n- Privileged Access Workstations"}
{"instruction": "Explain what Kerberoasting is and how it works.", "input": "I need to understand Kerberoasting for penetration testing.", "output": "Kerberoasting is an attack targeting service accounts in Active Directory by requesting and cracking Kerberos service tickets.\n\n[HOW IT WORKS]\n1. Attacker identifies service accounts with SPNs (Service Principal Names)\n2. Requests TGS (Ticket Granting Service) ticket for those services\n3. Extracts the ticket which is encrypted with the service account's hash\n4. Cracks the ticket offline to recover the password\n\n[REQUIREMENTS]\n- Valid domain user account (any user can request service tickets)\n- Service accounts with SPNs registered\n- Weak service account passwords\n\n[TOOLS]\n- Rubeus: kerberoast\n- Impacket: GetUserSPNs.py\n- PowerView: Invoke-Kerberoast\n\n[CRACKING]\nhashcat -m 13100 tickets.txt wordlist.txt\n\n[DETECTION]\n- Event ID 4769 (TGS request) with unusual volume\n- Requests for multiple services from single user\n- RC4 encryption requests (downgrade)\n\n[MITIGATION]\n- Strong passwords (25+ chars) for service accounts\n- Use MSA/gMSA (Managed Service Accounts)\n- Monitor for Kerberoasting indicators"}
{"instruction": "Explain what Golden Ticket is and how it works.", "input": "I need to understand Golden Ticket for penetration testing.", "output": "A Golden Ticket is a forged Kerberos TGT (Ticket Granting Ticket) that provides complete domain access by impersonating any user.\n\n[HOW IT WORKS]\n1. Attacker obtains the KRBTGT account's NTLM hash (via DCSync or DC compromise)\n2. Uses the hash to forge a TGT for any user, including Domain Admin\n3. The forged ticket is accepted by any system in the domain\n4. Valid until KRBTGT password is changed TWICE\n\n[REQUIREMENTS]\n- KRBTGT NTLM hash\n- Domain SID\n- Domain name\n\n[CREATION]\nUsing Mimikatz:\n```\nkerberos::golden /user:Administrator /domain:corp.local /sid:S-1-5-21-... /krbtgt:hash /id:500\n```\n\n[PERSISTENCE]\n- Ticket valid for 10 years by default\n- Survives password resets (except KRBTGT)\n- Works even if user account deleted\n\n[DETECTION]\n- TGT with unusual lifetime\n- TGT without corresponding AS-REQ\n- Authentication anomalies in logs\n\n[MITIGATION]\n- Protect Domain Controllers\n- Reset KRBTGT password periodically (TWICE)\n- Monitor for DCSync attempts"}
{"instruction": "Explain what LLMNR/NBT-NS Poisoning is and how it works.", "input": "I need to understand LLMNR/NBT-NS Poisoning for penetration testing.", "output": "LLMNR (Link-Local Multicast Name Resolution) and NBT-NS (NetBIOS Name Service) poisoning exploits Windows name resolution fallback mechanisms.\n\n[HOW IT WORKS]\n1. When a host can't resolve a name via DNS, it broadcasts LLMNR/NBT-NS queries\n2. Attacker on same network responds claiming to be the requested host\n3. Victim sends credentials (usually NTLMv2 hash) to attacker\n4. Attacker captures hash for offline cracking or relay attacks\n\n[REQUIREMENTS]\n- Network access (same broadcast domain as victims)\n- LLMNR/NBT-NS not disabled on target network\n- Users making typos or accessing unavailable resources\n\n[TOOLS]\n- Responder: responder -I eth0 -wrf\n- Inveigh (PowerShell): Invoke-Inveigh\n\n[CAPTURED DATA]\n- NTLMv1/v2 hashes (crack with hashcat -m 5600)\n- Potential for relay attacks (ntlmrelayx)\n\n[DETECTION]\n- Monitor for LLMNR/NBT-NS traffic\n- Honeypot names that shouldn't resolve\n- Network anomaly detection\n\n[MITIGATION]\n- Disable LLMNR and NBT-NS via GPO\n- Enable SMB signing (prevents relay)\n- Network segmentation"}
{"instruction": "Explain what Server-Side Request Forgery (SSRF) is and how it works.", "input": "I need to understand Server-Side Request Forgery (SSRF) for penetration testing.", "output": "SSRF is a vulnerability where an attacker can make a server perform requests to unintended locations, potentially accessing internal resources.\n\n[HOW IT WORKS]\n1. Application accepts user input for making HTTP requests (URLs, webhooks, etc.)\n2. Attacker provides URL pointing to internal resource or localhost\n3. Server makes request with its own privileges/network position\n4. Internal data returned to attacker or actions performed\n\n[COMMON TARGETS]\n- http://localhost/admin\n- http://169.254.169.254/ (cloud metadata)\n- http://internal.corp.local/\n- file:///etc/passwd\n\n[IMPACT]\n- Access internal services\n- Cloud metadata exposure (credentials)\n- Port scanning internal network\n- Potential RCE via internal services\n\n[BYPASS TECHNIQUES]\n- IP encoding: 0x7f.0x0.0x0.0x1 = 127.0.0.1\n- DNS rebinding\n- URL parser confusion\n- Protocol handlers: gopher://, dict://\n\n[DETECTION]\n- Monitor outbound requests from web servers\n- Unusual DNS queries from web servers\n- Requests to metadata endpoints\n\n[MITIGATION]\n- Whitelist allowed URLs/domains\n- Block internal IP ranges\n- Disable unnecessary URL schemes\n- Use network segmentation"}
{"instruction": "Explain what DCShadow is and how it works.", "input": "I need to understand DCShadow for penetration testing.", "output": "DCShadow is a stealthy persistence technique that registers a rogue Domain Controller to push malicious changes to Active Directory.\n\n[HOW IT WORKS]\n1. Attacker registers compromised server as a DC in AD\n2. Pushes malicious changes (backdoor admin, modify ACLs, etc.)\n3. Changes replicate to legitimate DCs\n4. Rogue DC unregisters, leaving minimal traces\n\n[REQUIREMENTS]\n- Domain Admin or equivalent privileges\n- Direct network access to DC\n- Mimikatz on compromised system\n\n[EXECUTION]\nUsing Mimikatz (two sessions):\n```\n# Session 1: Register rogue DC\nlsadump::dcshadow /object:user /attribute:... /value:...\n\n# Session 2: Push changes\nlsadump::dcshadow /push\n```\n\n[USE CASES]\n- Add user to privileged groups\n- Modify SID History\n- Change password without logging\n- Inject malicious SPNs\n\n[DETECTION]\n- New DCs appearing in AD\n- Replication from unknown sources\n- Event ID 4742 (computer account modified)\n\n[MITIGATION]\n- Monitor for new DC registrations\n- Protect Domain Admins\n- Advanced threat detection solutions"}
